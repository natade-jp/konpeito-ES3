/*!
 * konpeito-ES3.js (version 1.2.0, 2021/5/6)
 * https://github.com/natade-jp/konpeito-ES3
 * Copyright 2013-2021 natade < https://github.com/natade-jp >
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self)["konpeito-ES3"]=r()}(this,function(){"use strict";function t(){}t.run=function(){Math.imul||(Math.imul=function(t,r){var n=(65535&t)*(65535&r)>>>0,e=(65535&t)*(r>>>16);return n=n+((65535&e)<<16)>>>0,4294967295&(n+=(65535&(e=(t>>>16)*(65535&r)))<<16)}),Math.trunc||(Math.trunc=function(t){return 0<t?Math.floor(t):Math.ceil(t)}),Math.cbrt||(Math.cbrt=function(t){return Math.exp(Math.log(t)/3)}),Math.expm1||(Math.expm1=function(t){return Math.exp(t)-1}),Math.log1p||(Math.log1p=function(t){return Math.log(t+1)}),Math.log2||(Math.log2=function(t){return Math.log(t)/Math.log(2)}),Math.log10||(Math.log10=function(t){return Math.log(t)/Math.log(10)}),void 0===Math.E&&(Math.E=2.718281828459045),void 0===Math.LN10&&(Math.LN10=Math.log(10)),void 0===Math.LN2&&(Math.LN2=Math.log(2)),void 0===Math.LOG2E&&(Math.LOG2E=Math.log2(Math.E)),void 0===Math.LOG10E&&(Math.LOG10E=Math.log10(Math.E)),void 0===Math.PI&&(Math.PI=3.141592653589793),void 0===Math.SQRT1_2&&(Math.SQRT1_2=Math.pow(.5,.5)),void 0===Math.SQRT2&&(Math.SQRT2=Math.pow(2,.5)),Number.isFinite||(Number.isFinite=isFinite),Number.isInteger||(Number.isInteger=function(t){return isFinite(t)&&Math.trunc(t)===t}),Number.isNaN||(Number.isNaN=isNaN),void 0===Number.NaN&&(Number.NaN=NaN),void 0===Number.EPSILON&&(Number.EPSILON=2220446049250313e-31),void 0===Number.MIN_SAFE_INTEGER&&(Number.MIN_SAFE_INTEGER=-9007199254740991),void 0===Number.MAX_SAFE_INTEGER&&(Number.MAX_SAFE_INTEGER=9007199254740991),Number.parseFloat||(Number.parseFloat=parseFloat),Number.parseInt||(Number.parseInt=parseInt),Number.isSafeInteger||(Number.isSafeInteger=function(t){return Number.isInteger(t)&&Math.abs(t)<=Number.MAX_SAFE_INTEGER});var t=[0,0];if(t.splice(1),1!==t.length){var e=Array.prototype.splice;Array.prototype.splice=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r.push(t[n]);return 1===arguments.length&&r.push(this.length-arguments[0]),e.apply(this,r)}}},t.run();function e(t){return t-Math.trunc(t)!=0}function l(){}l.gammaln=function(t){if(!isFinite(t))return isNaN(t)?NaN:1/0;for(var r=Math.log(2*Math.PI),n=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],e=1,o=t;o<n.length;)e*=o,o++;for(var i=1/(o*o),a=n[0],u=1;u<n.length;u++)a*=i,a+=n[u];return a/=o,a+=.5*r,a+=-Math.log(e)-o+(o-.5)*Math.log(o)},l.q_gamma=function(t,r,n){if(!isFinite(t))return t===1/0?0:NaN;var e,o,i,a,u,h=1,s=1+t-r;if(t<1+r)return 1-l.p_gamma(t,r,n);for(o=(i=Math.exp(r*Math.log(t)-t-n))/s,e=2;e<1e3;e++)if(a=((e-1-r)*(s-h)+(e+t)*s)/e,u=o,(o+=a=(i*=(e-1-r)/e)/((h=s)*(s=a)))==u)return o;return Number.NaN},l.p_gamma=function(t,r,n){if(!isFinite(t))return t===1/0?1:NaN;var e,o,i,a;if(1+r<=t)return 1-l.q_gamma(t,r,n);if(0===t)return 0;for(o=i=Math.exp(r*Math.log(t)-t-n)/r,e=1;e<1e3;e++)if(a=o,(o+=i*=t/(r+e))==a)return o;return Number.NaN},l.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(l.gammaln(1-t))):Math.exp(l.gammaln(t))},l.gammainc=function(t,r,n){if("lower"===n)return l.p_gamma(t,r,l.gammaln(r));if("upper"===n)return l.q_gamma(t,r,l.gammaln(r));if(void 0===n)return l.gammainc(t,r,"lower");throw"gammainc unsupported argument ["+n+"]"},l.gampdf=function(t,r,n){if(t===-1/0)return 0;var e=1/(l.gamma(r)*Math.pow(n,r));return e*=Math.pow(t,r-1),e*=Math.exp(-t/n)},l.gamcdf=function(t,r,n){return t<0?0:l.gammainc(t/n,r)},l.gaminv=function(t,r,n){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var e,o,i=r*n,a=0;a<100&&(e=(o=i-(l.gamcdf(i,r,n)-t)/l.gampdf(i,r,n))-i,!(Math.abs(e)<=1e-12));a++)(i=o)<0&&(i=1e-12);return i},l.beta=function(t,r){return Math.exp(l.gammaln(t)+l.gammaln(r)-l.gammaln(t+r))},l.p_beta=function(t,r,n){var e,o,i,a;if(r<=0)return Number.POSITIVE_INFINITY;if(n<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((r+1)/(r+n+2)<t)return 1-l.p_beta(1-t,n,r);if(t<=0)return 0;for(i=r*Math.log(t),i+=n*Math.log(1-t),i+=l.gammaln(r+n),i-=l.gammaln(r)+l.gammaln(n),i=Math.exp(i),o=i/=r,e=1;e<1e3;e++)if(i*=r+n+e-1,i*=t,a=o,(o+=i/=r+e)===a)return o;return Number.NaN},l.q_beta=function(t,r,n){return 1-l.p_beta(t,r,n)},l.betainc=function(t,r,n,e){if("lower"===e)return l.p_beta(t,r,n);if("upper"===e)return l.q_beta(t,r,n);if(void 0===e)return l.betainc(t,r,n,"lower");throw"betainc unsupported argument ["+e+"]"},l.betapdf=function(t,r,n){return t<0&&e(n-1)||1-t<0&&e(n-1)?0:Math.pow(t,r-1)*Math.pow(1-t,n-1)/l.beta(r,n)},l.betacdf=function(t,r,n){return l.betainc(t,r,n)},l.betainv=function(t,r,n){if(t<0||1<t)return Number.NaN;if(0==t&&0<r&&0<n)return 0;if(1==t&&0<r&&0<n)return 1;var e,o,i,a=1e-14;e=0==n?1-a:0==r?a:r/(r+n);for(var u=0;u<100&&(o=(i=e-(l.betacdf(e,r,n)-t)/l.betapdf(e,r,n))-e,!(Math.abs(o)<=a));u++)1<(e=i)?e=1-a:e<0&&(e=a);return e},l.factorial=function(t){var r=l.gamma(t+1);return Math.trunc(t)===t?Math.round(r):r},l.nchoosek=function(t,r){for(var n=1,e=Math.min(r,t-r),o=1;o<=e;o++)if((n*=(t+1-o)/o)>=Number.MAX_SAFE_INTEGER)return 1/0;return n},l.erf=function(t){return l.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},l.erfc=function(t){return 1-l.erf(t)},l.erfinv=function(t){return l.erfcinv(1-t)},l.erfcinv=function(t){return-l.norminv(.5*t)/Math.sqrt(2)},l.normpdf=function(t,r,n){var e="number"==typeof r?r:0,o="number"==typeof n?n:1,i=1/Math.sqrt(2*Math.PI*o*o);return i*=Math.exp(-(t-e)*(t-e)/(2*o*o))},l.normcdf=function(t,r,n){return(1+l.erf((t-("number"==typeof r?r:0))/(("number"==typeof n?n:1)*Math.sqrt(2))))/2},l.norminv=function(t,r,n){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var e,o,i="number"==typeof r?r:0,a="number"==typeof n?n:1,u=i,h=0;h<200&&(e=(o=u-(l.normcdf(u,i,a)-t)/l.normpdf(u,i,a))-u,!(Math.abs(e)<=1e-12));h++)u=o;return u},l.binopdf=function(t,r,n){return isFinite(n)?l.nchoosek(r,t)*Math.pow(n,t)*Math.pow(1-n,r-t):isNaN(n)?NaN:0},l.binocdf=function(t,r,n,e){return l.betainc(1-n,r-Math.floor(t),1+Math.floor(t),e)},l.binoinv=function(t,r,n){if(t<0||1<t||n<0||1<n)return Number.NaN;if(0==t||0==n)return 0;if(1==n)return r;for(var e=1,o=r,i=0,a=0,u=0;u<200;u++){i=Math.round((e+o)/2);var h=l.binocdf(i,r,n);if(i===a)break;t<h?o=i:e=i,a=i}return i},l.poisspdf=function(t,r){if(!isFinite(t))return isNaN(t)?Number.NaN:0;for(var n=1/Math.E,e=1,o=0,i=1;i<=t;i++)e=e*r/i,o<r&&(e*=n,o++);for(;o<r;o++)e*=n;return e},l.poisscdf=function(t,r){return t<0?0:1-l.gammainc(r,Math.floor(t+1))},l.poissinv=function(t,r){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n=1,e=20*r,o=0,i=0,a=0;a<200;a++){o=Math.round((n+e)/2);var u=l.poisscdf(o,r);if(o===i)break;t<u?e=o:n=o,i=o}return o},l.tpdf=function(t,r){var n=1/(Math.sqrt(r)*l.beta(.5,.5*r));return n*=Math.pow(1+t*t/r,.5*-(r+1))},l.tcdf=function(t,r){return.5*(1+l.betainc(t*t/(r+t*t),.5,.5*r)*(t<0?-1:1))},l.tinv=function(t,r){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var n=l.betainv(2*t,.5*r,.5);return-Math.sqrt(r/n-r)}var e=l.betainv(2*(1-t),.5*r,.5);return Math.sqrt(r/e-r)},l.tdist=function(t,r,n){return(1-l.tcdf(Math.abs(t),r))*n},l.tinv2=function(t,r){return-l.tinv(.5*t,r)},l.chi2pdf=function(t,r){if(t<0)return 0;if(0===t)return.5;var n=Math.pow(t,r/2-1)*Math.exp(-t/2);return n/=Math.pow(2,r/2)*l.gamma(r/2)},l.chi2cdf=function(t,r){return l.gammainc(t/2,r/2)},l.chi2inv=function(t,r){return l.gaminv(t,r/2,2)},l.fpdf=function(t,r,n){if(r<0||n<0)return Number.NaN;if(t<=0)return 0;var e=1;return e*=Math.pow(r*t/(r*t+n),r/2),e*=Math.pow(1-r*t/(r*t+n),n/2),e/=t*l.beta(r/2,n/2)},l.fcdf=function(t,r,n){return l.betacdf(r*t/(r*t+n),r/2,n/2)},l.finv=function(t,r,n){return(1/l.betainv(1-t,n/2,r/2)-1)*n/r};function n(t,r){var n=(65535&t)*(65535&r)>>>0,e=(65535&t)*(r>>>16);return n=(n=n+((65535&e)<<16)>>>0)+((65535&(e=(t>>>16)*(65535&r)))<<16)>>>0}function v(t){if(this.x=123456789,this.y=362436069,this.z=521288629,this.w=88675123,void 0!==t)this.setSeed(t);else{var r=(new Date).getTime()+v.seedUniquifier&4294967295;v.seedUniquifier=v.seedUniquifier+1&4294967295,this.setSeed(r)}}v.prototype.setSeed=function(t){var r=t;r=n(r,214013)+2531011>>>0,this.z=r,r=n(r,214013)+2531011>>>0,this.w=r,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},v.prototype.genrand_int32=function(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w},v.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.next(32)+this.next(32):64===t?4294967296*this.next(32)+this.next(32):t<64?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},v.prototype.nextBytes=function(t){for(var r=new Array(t),n=0;n<r.length;n++)r[n]=this.next(8);return r},v.prototype.nextShort=function(){return this.next(16)},v.prototype.nextInt=function(t){if(void 0===t||"number"!=typeof t)return 0|this.next(32);for(var r,n;n=(r=this.genrand_int32()>>>0)%t,4294967296<r-n+t;);return n},v.prototype.nextLong=function(){return this.next(64)},v.prototype.nextBoolean=function(){return 0!==this.next(1)},v.prototype.nextFloat=function(){return this.next(24)/16777216},v.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},v.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),r=2*Math.PI*this.nextDouble(),n=t*Math.sin(r);return this.nextNextGaussian=t*Math.cos(r),this.haveNextNextGaussian=!0,n},v.seedUniquifier=2271560481;function o(t){return!!t.isComplexData&&t.isComplexData()}function i(){}var a=new v;i.ToComplexFromString=function(t){var r=t.replace(/\s/g,"").toLowerCase();if(r=r.replace(/infinity|inf/g,"1e100000"),!/[ij]/.test(r))return{real:parseFloat(r),imag:0};var n,e=0,o=0;return(n=r.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))($|[+-])/))&&(e=parseFloat(n[0])),(n=r.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]/))&&(n=n[0].substring(0,n[0].length-1),o=/^[-+]$/.test(n)||0===n.length?"-"===n?-1:1:parseFloat(n)),{real:e,imag:o}};function A(t){if(1!==arguments.length)throw"Complex Many arguments : "+arguments.length;var r=t;if(o(r))this._re=r._re,this._im=r._im;else if("number"==typeof r)this._re=r,this._im=0;else if("string"==typeof r){var n=i.ToComplexFromString(r);this._re=n.real,this._im=n.imag}else if(r instanceof Array){if(2!==r.length)throw"Complex Unsupported argument "+arguments;this._re=r[0],this._im=r[1]}else if("boolean"==typeof r)this._re=r?1:0,this._im=0;else if("_re"in r&&"_im"in r)this._re=r._re,this._im=r._im;else{if(!o(r))throw"Complex Unsupported argument "+arguments;var e=i.ToComplexFromString(r.toString());this._re=e.real,this._im=e.imag}}A.create=function(t){return o(t)?t:new A(t)},A.valueOf=function(t){return A.create(t)},A._toComplex=function(t){return o(t)?t:void 0!==t.toComplex?t.toComplex():new A(t)},A._toDouble=function(t){if("number"==typeof t)return t;var r=A._toComplex(t);if(r.isReal())return r.real();throw"not support complex numbers.["+t+"]"},A._toInteger=function(t){return Math.trunc(A._toDouble(t))},A.prototype.clone=function(){return this},A.prototype.toString=function(){function t(t){var r=t.toPrecision(6);if(-1!==r.indexOf("."))r=(r=r.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e");else{if(/inf/i.test(r))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(r))return"NaN"}return r}return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im||Number.isNaN(this._im)?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},A.prototype.toJSON=function(){return this.isReal()?this._re.toString():0===this._re?this._im.toString()+"i":0<=this._im||Number.isNaN(this._im)?this._re.toString()+"+"+this._im.toString()+"i":this._re.toString()+this._im.toString()+"i"},A.prototype.real=function(){return this._re},A.prototype.imag=function(){return this._im},A.prototype.norm=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},A.prototype.arg=function(){return 0===this._im?0<=this._re?0:Math.PI:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},A.prototype.getDecimalPosition=function(){function t(t){if(!Number.isFinite(t))return 0;for(var r=t,n=0,e=0;e<20&&!(Math.abs(r-Math.round(r))<=Number.EPSILON);e++)r*=10,n++;return n}return Math.max(t(this.real()),t(this.imag()))},A.prototype.sign=function(){return this.isFinite()?0===this._im?0===this._re?A.ZERO:new A(0<this._re?1:-1):this.div(this.norm()):this.isNaN()||this._im===1/0||this._im===-1/0?A.NaN:this._re===1/0?A.ONE:A.MINUS_ONE},A.prototype.add=function(t){var r=new A(t);return r._re=this._re+r._re,r._im=this._im+r._im,r},A.prototype.sub=function(t){var r=new A(t);return r._re=this._re-r._re,r._im=this._im-r._im,r},A.prototype.mul=function(t){var r=this,n=new A(t);if(0===r._im&&0===n._im)return n._re=r._re*n._re,n;if(0===r._re&&0===n._re)return n._re=-r._im*n._im,n._im=0,n;var e=r._re*n._re-r._im*n._im,o=r._im*n._re+r._re*n._im;return n._re=e,n._im=o,n},A.prototype.dot=function(t){var r=this,n=new A(t);if(0===r._im&&0===n._im)return n._re=r._re*n._re,n;if(0===r._re&&0===n._re)return n._re=r._im*n._im,n._im=0,n;var e=r._re*n._re+r._im*n._im,o=-r._im*n._re+r._re*n._im;return n._re=e,n._im=o,n},A.prototype.div=function(t){var r=this,n=new A(t);if(0===r._im&&0===n._im)return n._re=r._re/n._re,n;if(0===r._re&&0===n._re)return n._re=r._im/n._im,n._im=0,n;var e=r._re*n._re+r._im*n._im,o=r._im*n._re-r._re*n._im,i=1/(n._re*n._re+n._im*n._im);return n._re=e*i,n._im=o*i,n},A.prototype.rem=function(t){var r=new A(t);if(0!==this._im||0!==r._im)throw"calculation method is undefined.";return this.isFinite()&&r.isFinite()&&!r.isZero()?(r._re=this._re-r._re*Math.trunc(this._re/r._re),r):A.NaN},A.prototype.mod=function(t){var r=new A(t);if(0!==this._im||0!==r._im)throw"calculation method is undefined.";if(r.isZero())return this;var n=this.rem(r);return this.equalsState(r)?n:n.add(r)},A.prototype.inv=function(){return 0===this._im?new A(1/this._re):0===this._re?new A([0,-1/this._im]):A.ONE.div(this)},A.prototype.booleanValue=function(){return!this.isZero()&&!this.isNaN()},A.prototype.intValue=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this._re;return Math.abs(t-Math.trunc(t))<Number.EPSILON?Math.round(t):Math.trunc(t)},A.prototype.doubleValue=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this._re;return Math.abs(t-Math.trunc(t))<Number.EPSILON?Math.round(t):t},A.prototype.toComplex=function(){return this},A.prototype.equals=function(t,r){var n=this,e=A._toComplex(t);if(n.isNaN()||e.isNaN())return!1;if(n._re===e._re&&n._im===e._im)return!0;var o=r?A._toDouble(r):Number.EPSILON;return Math.abs(n._re-e._re)<o&&Math.abs(n._im-e._im)<o},A.prototype.equalsState=function(t){function r(t){return t.isZero()?0:t.isFinite()?t.isPositive()?1:2:t.isPositiveInfinity()?4:t.isNegativeInfinity()?5:3}var n=A._toComplex(t);return r(this)===r(n)},A.prototype.compareTo=function(t,r){var n=this,e=A._toComplex(t);if(!n.isFinite()||!e.isFinite())return n.equals(e)?0:n.isNaN()||e.isNaN()||n.real()===1/0&&n.imag()===-1/0||n.real()===-1/0&&n.imag()===1/0||e.real()===1/0&&e.imag()===-1/0||e.real()===-1/0&&e.imag()===1/0?NaN:n.isFinite()?e.real()+e.imag()<0?1:-1:e.isFinite()?0<n.real()+n.imag()?1:-1:NaN;var o=r?A._toDouble(r):Number.EPSILON,i=n.real()+n.imag(),a=e.real()+e.imag();return Math.abs(i-a)<=o?0:a<i?1:-1},A.prototype.max=function(t){var r=A._toComplex(t);return 0<=this.compareTo(r)?this:r},A.prototype.min=function(t){var r=A._toComplex(t);return this.compareTo(r)<=0?this:r},A.prototype.clip=function(t,r){var n=A._toComplex(t),e=A._toComplex(r),o=n.compareTo(e);if(1===o)throw"clip(min, max) error. (min > max)->("+n+" > "+e+")";return 0===o?n:1===this.compareTo(e)?e:-1===this.compareTo(n)?n:this},A.prototype.floor=function(){return new A([Math.floor(this._re),Math.floor(this._im)])},A.prototype.ceil=function(){return new A([Math.ceil(this._re),Math.ceil(this._im)])},A.prototype.round=function(){return new A([Math.round(this._re),Math.round(this._im)])},A.prototype.fix=function(){return new A([Math.trunc(this._re),Math.trunc(this._im)])},A.prototype.fract=function(){return new A([this._re-Math.floor(this._re),this._im-Math.floor(this._im)])},A.prototype.abs=function(){return new A(this.norm())},A.prototype.conj=function(){return 0===this._im?this:new A([this._re,-this._im])},A.prototype.negate=function(){return new A([-this._re,-this._im])},A.prototype.pow=function(t){var r=this,n=new A(t);if(n.isReal()){if(r.isReal()&&(r.isNotNegative()||n.isInteger()))return n._re=Math.pow(r._re,n._re),n;var e=Math.pow(r.norm(),n._re),o=r.arg()*n._re;return n._re=e*Math.cos(o),n._im=e*Math.sin(o),n}return n.mul(r.log()).exp()},A.prototype.square=function(){return 0===this._im?new A(this._re*this._re):this.mul(this)},A.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new A(Math.sqrt(this._re)):new A([0,Math.sqrt(-this._re)]);var t=Math.sqrt(this.norm()),r=.5*this.arg();return new A([t*Math.cos(r),t*Math.sin(r)])},A.prototype.cbrt=function(t){var r=A._toInteger(void 0!==t?t:0),n=this.log().div(3).exp();return 0===r?n:1===r?n.mul([-.5,.5*Math.sqrt(3)]):n.mul([-.5,.5*-Math.sqrt(3)])},A.prototype.rsqrt=function(){return this.isReal()?this.isNotNegative()?new A(1/Math.sqrt(this._re)):new A([0,-1/Math.sqrt(-this._re)]):this.sqrt().inv()},A.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new A(Math.log(this._re)):new A([Math.log(this.norm()),this.arg()])},A.prototype.exp=function(){if(this.isReal())return new A(Math.exp(this._re));var t=Math.exp(this._re);return new A([t*Math.cos(this._im),t*Math.sin(this._im)])},A.prototype.expm1=function(){return this.exp().sub(1)},A.prototype.log1p=function(){return this.add(1).log()},A.prototype.log2=function(){return this.log().div(A.LN2)},A.prototype.log10=function(){return this.log().div(A.LN10)},A.prototype.sin=function(){if(this.isReal())return new A(Math.sin(this._re));var t=this.mul(A.I).exp(),r=this.mul(A.I.negate()).exp();return t.sub(r).div([0,2])},A.prototype.cos=function(){if(this.isReal())return new A(Math.cos(this._re));var t=this.mul(A.I).exp(),r=this.mul(A.I.negate()).exp();return t.add(r).div(2)},A.prototype.tan=function(){return this.isReal()?new A(Math.tan(this._re)):this.sin().div(this.cos())},A.prototype.atan=function(){return this.isReal()?new A(Math.atan(this._re)):A.I.div(A.TWO).mul(A.I.add(this).div(A.I.sub(this)).log())},A.prototype.atan2=function(t){if(0===arguments.length)return new A(this.arg());var r=A._toComplex(t);if(this.isReal()&&r.isReal())return new A(Math.atan2(this._re,r._re));throw"calculation method is undefined."},A.prototype.asin=function(){return this.mul(A.I).add(A.ONE.sub(this.square()).sqrt()).log().mul(A.MINUS_I)},A.prototype.acos=function(){return this.add(A.I.mul(A.ONE.sub(this.square()).sqrt())).log().mul(A.MINUS_I)},A.prototype.sinh=function(){var t=this.exp();return t.sub(t.inv()).mul(.5)},A.prototype.asinh=function(){return this.isInfinite()?this:this.add(this.mul(this).add(1).sqrt()).log()},A.prototype.cosh=function(){return this.exp().add(this.negate().exp()).mul(.5)},A.prototype.acosh=function(){return this.isZero()?new A([0,.5*Math.PI]):1<=this.compareTo(A.ONE)?this.add(this.square().sub(1).sqrt()).log():this.sub(this.square().sub(1).sqrt()).log()},A.prototype.tanh=function(){if(this.isNaN())return A.NaN;var t=this.mul(2).exp();return t.isZero()?A.MINUS_ONE:t.isPositiveInfinity()?A.ONE:t.sub(1).div(t.add(1))},A.prototype.atanh=function(){return this.isInfinite()&&this.isReal()?new A([0,.5*Math.PI]):this.add(1).div(this.negate().add(1)).log().mul(.5)},A.prototype.sec=function(){return this.cos().inv()},A.prototype.asec=function(){return this.inv().acos()},A.prototype.sech=function(){return this.exp().add(this.negate().exp()).inv().mul(2)},A.prototype.asech=function(){return this.isInfinite()&&this.isReal()?new A([0,.5*Math.PI]):this.isPositive()||-1==this.compareTo(A.MINUS_ONE)?this.inv().add(this.square().inv().sub(1).sqrt()).log():this.inv().sub(this.square().inv().sub(1).sqrt()).log()},A.prototype.cot=function(){return this.tan().inv()},A.prototype.acot=function(){return this.inv().atan()},A.prototype.coth=function(){return this.isZero()?A.POSITIVE_INFINITY:this.tanh().inv()},A.prototype.acoth=function(){return this.isInfinite()?A.ZERO:this.add(1).div(this.sub(1)).log().mul(.5)},A.prototype.csc=function(){return this.sin().inv()},A.prototype.acsc=function(){return this.inv().asin()},A.prototype.csch=function(){return this.exp().sub(this.negate().exp()).inv().mul(2)},A.prototype.acsch=function(){return this.inv().add(this.square().inv().add(1).sqrt()).log()},A.prototype.logit=function(){return this.log().sub(A.ONE.sub(this).log())},A.prototype.sinc=function(){if(this.isReal()){if(0===this._re)return A.ONE;var t=Math.PI*this._re;return new A(Math.sin(t)/t)}var r=this.mul(A.PI);return new A(r.sin().div(r))},A.rand=function(t){var r=void 0!==t&&t instanceof v?t:a;return new A(r.nextDouble())},A.randn=function(t){return new A((void 0!==t&&t instanceof v?t:a).nextGaussian())},A.prototype.isInteger=function(t){var r=t?A._toDouble(t):Number.EPSILON;return this.isReal()&&Math.abs(this._re-Math.trunc(this._re))<r},A.prototype.isComplexInteger=function(t){var r=t?A._toDouble(t):Number.EPSILON;return Math.abs(this._re-Math.trunc(this._re))<r&&Math.abs(this._im-Math.trunc(this._im))<r},A.prototype.isZero=function(t){var r=t?A._toDouble(t):Number.EPSILON;return Math.abs(this._re)<r&&Math.abs(this._im)<r},A.prototype.isOne=function(t){var r=t?A._toDouble(t):Number.EPSILON;return Math.abs(this._re-1)<r&&Math.abs(this._im)<r},A.prototype.isComplex=function(t){var r=t?A._toDouble(t):Number.EPSILON;return Math.abs(this._im)>=r},A.prototype.isReal=function(t){var r=t?A._toDouble(t):Number.EPSILON;return Math.abs(this._im)<r},A.prototype.isNaN=function(){return isNaN(this._re)||isNaN(this._im)},A.prototype.isPositive=function(){return 0<this._re},A.prototype.isNegative=function(){return this._re<0},A.prototype.isNotNegative=function(){return 0<=this._re},A.prototype.isPositiveInfinity=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY},A.prototype.isNegativeInfinity=function(){return this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},A.prototype.isInfinite=function(){return this.isPositiveInfinity()||this.isNegativeInfinity()},A.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},A.prototype.gammaln=function(){return new A(l.gammaln(this._re))},A.prototype.gamma=function(){return new A(l.gamma(this._re))},A.prototype.gammainc=function(t,r){var n=A._toDouble(t);return new A(l.gammainc(this._re,n,r))},A.prototype.gampdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.gampdf(this._re,n,e))},A.prototype.gamcdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.gamcdf(this._re,n,e))},A.prototype.gaminv=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.gaminv(this._re,n,e))},A.prototype.beta=function(t){var r=A._toDouble(t);return new A(l.beta(this._re,r))},A.prototype.betainc=function(t,r,n){var e=A._toDouble(t),o=A._toDouble(r);return new A(l.betainc(this._re,e,o,n))},A.prototype.betapdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.betapdf(this._re,n,e))},A.prototype.betacdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.betacdf(this._re,n,e))},A.prototype.betainv=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.betainv(this._re,n,e))},A.prototype.factorial=function(){return new A(l.factorial(this._re))},A.prototype.nchoosek=function(t){var r=A._toDouble(t);return new A(l.nchoosek(this._re,r))},A.prototype.erf=function(){return new A(l.erf(this._re))},A.prototype.erfc=function(){return new A(l.erfc(this._re))},A.prototype.erfinv=function(){return new A(l.erfinv(this._re))},A.prototype.erfcinv=function(){return new A(l.erfcinv(this._re))},A.prototype.normpdf=function(t,r){var n=void 0!==t?A._toDouble(t):0,e=void 0!==r?A._toDouble(r):1;return new A(l.normpdf(this._re,n,e))},A.prototype.normcdf=function(t,r){var n=void 0!==t?A._toDouble(t):0,e=void 0!==r?A._toDouble(r):1;return new A(l.normcdf(this._re,n,e))},A.prototype.norminv=function(t,r){var n=void 0!==t?A._toDouble(t):0,e=void 0!==r?A._toDouble(r):1;return new A(l.norminv(this._re,n,e))},A.prototype.binopdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.binopdf(this._re,n,e))},A.prototype.binocdf=function(t,r,n){var e=A._toDouble(t),o=A._toDouble(r);return new A(l.binocdf(this._re,e,o,n))},A.prototype.binoinv=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.binoinv(this._re,n,e))},A.prototype.poisspdf=function(t){var r=A._toDouble(t);return new A(l.poisspdf(this._re,r))},A.prototype.poisscdf=function(t){var r=A._toDouble(t);return new A(l.poisscdf(this._re,r))},A.prototype.poissinv=function(t){var r=A._toDouble(t);return new A(l.poissinv(this._re,r))},A.prototype.tpdf=function(t){var r=A._toDouble(t);return new A(l.tpdf(this._re,r))},A.prototype.tcdf=function(t){var r=A._toDouble(t);return new A(l.tcdf(this._re,r))},A.prototype.tinv=function(t){var r=A._toDouble(t);return new A(l.tinv(this._re,r))},A.prototype.tdist=function(t,r){var n=A._toDouble(t),e=A._toInteger(r);return new A(l.tdist(this._re,n,e))},A.prototype.tinv2=function(t){var r=A._toDouble(t);return new A(l.tinv2(this._re,r))},A.prototype.chi2pdf=function(t){var r=A._toDouble(t);return new A(l.chi2pdf(this._re,r))},A.prototype.chi2cdf=function(t){var r=A._toDouble(t);return new A(l.chi2cdf(this._re,r))},A.prototype.chi2inv=function(t){var r=A._toDouble(t);return new A(l.chi2inv(this._re,r))},A.prototype.fpdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.fpdf(this._re,n,e))},A.prototype.fcdf=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.fcdf(this._re,n,e))},A.prototype.finv=function(t,r){var n=A._toDouble(t),e=A._toDouble(r);return new A(l.finv(this._re,n,e))},A.prototype.and=function(t){var r=Math.round(this.real()),n=Math.round(A._toDouble(t));return new A(r&n)},A.prototype.or=function(t){var r=Math.round(this.real()),n=Math.round(A._toDouble(t));return new A(r|n)},A.prototype.xor=function(t){var r=Math.round(this.real()),n=Math.round(A._toDouble(t));return new A(r^n)},A.prototype.not=function(){var t=Math.round(this.real());return new A(!t)},A.prototype.shift=function(t){var r=Math.round(this.real()),n=Math.round(A._toDouble(t));return new A(r<<n)},A.prototype.scaleByPowerOfTen=function(t){return this.mul(A.TEN.pow(t))},A.prototype.signum=function(){return this.sign()},A.prototype.subtract=function(t){return this.sub(t)},A.prototype.multiply=function(t){return this.mul(t)},A.prototype.divide=function(t){return this.div(t)},A.prototype.remainder=function(t){return this.rem(t)},A.prototype.trunc=function(){return this.fix()},A.prototype.isComplexData=function(){return!0};var r={ZERO:new A(0),ONE:new A(1),TWO:new A(2),TEN:new A(10),MINUS_ONE:new A(-1),I:new A([0,1]),MINUS_I:new A([0,-1]),PI:new A(Math.PI),QUARTER_PI:new A(.25*Math.PI),HALF_PI:new A(.5*Math.PI),TWO_PI:new A(2*Math.PI),E:new A(Math.E),LN2:new A(Math.LN2),LN10:new A(Math.LN10),LOG2E:new A(Math.LOG2E),LOG10E:new A(Math.LOG10E),SQRT2:new A(Math.SQRT2),SQRT1_2:new A(Math.SQRT1_2),HALF:new A(.5),POSITIVE_INFINITY:new A(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new A(Number.NEGATIVE_INFINITY),NaN:new A(Number.NaN)};A.ONE=r.ONE,A.TWO=r.TWO,A.TEN=r.TEN,A.ZERO=r.ZERO,A.MINUS_ONE=r.MINUS_ONE,A.I=r.I,A.MINUS_I=r.MINUS_I,A.PI=r.PI,A.QUARTER_PI=r.QUARTER_PI,A.HALF_PI=r.HALF_PI,A.TWO_PI=r.TWO_PI,A.E=r.E,A.LN2=r.LN2,A.LN10=r.LN10,A.LOG2E=r.LOG2E,A.LOG10E=r.LOG10E,A.SQRT2=r.SQRT2,A.SQRT1_2=r.SQRT1_2,A.HALF=r.HALF,A.POSITIVE_INFINITY=r.POSITIVE_INFINITY,A.NEGATIVE_INFINITY=r.NEGATIVE_INFINITY,A.NaN=r.NaN;function M(){}M.tridiagonalize=function(t){for(var r=$._toMatrix(t).getNumberMatrixArray(),l=function(t,r,n,e){for(var o=0,i=n||0,a=e||t.length,u=i;u<a;u++)o+=t[u]*r[u];return o},n=function(t,r,n){var e=r||0,o=n||t.length,i=Math.sqrt(l(t,t,e,o)),a=[];if(1e-10<=Math.abs(i)){var u;t[e]<0&&(i=-i);for(var h=e,s=0;h<o;h++,s++)h===e?(a[s]=t[h]+i,u=1/Math.sqrt(a[s]*i),a[s]=a[s]*u):a[s]=t[h]*u}return{y1:-i,v:a}},e=r.length,o=[],i=[],a=0;a<e-2;a++){var u=r[a];o[a]=u[a];var h=n(u,a+1,e);i[a]=h.y1;for(var s=0;s<h.v.length;s++)u[a+1+s]=h.v[s];if(!(Math.abs(i[a])<1e-10)){for(var c=a+1;c<e;c++){for(var f=0,_=a+1;_<c;_++)f+=r[_][c]*u[_];for(var p=c;p<e;p++)f+=r[c][p]*u[p];o[c]=f}for(var m=l(u,o,a+1,e)/2,g=e-1;a<g;g--){var v=u[g],y=o[g]-m*v;o[g]=y;for(var w=g;w<e;w++){var d=v*o[w]+y*u[w];r[g][w]=r[g][w]-d}}}}2<=e&&(o[e-2]=r[e-2][e-2],i[e-2]=r[e-2][e-1]),1<=e&&(o[e-1]=r[e-1][e-1]);for(var x=e-1;0<=x;x--){var M=r[x];if(x<e-2)for(var b=x+1;b<e;b++)for(var N=r[b],E=l(M,N,x+1,e),I=x+1;I<e;I++)N[I]-=E*M[I];for(var D=0;D<e;D++)M[D]=0;M[x]=1}var C=$.createMatrixDoEachCalculation(function(t,r){return t===r?new A(o[t]):1===Math.abs(t-r)?new A(i[Math.trunc(.5*(t+r))]):A.ZERO},e,e);return{P:new $(r).T(),H:C}},M.eig=function(t){for(var r=$._toMatrix(t),n=!1,e=M.tridiagonalize(r),o=e.P.getNumberMatrixArray(),i=e.H.getNumberMatrixArray(),a=r.row_length,u=[],h=[],s=0;s<a;s++)u[s]=i[s][s],h[s]=0===s?0:i[s][s-1];for(var l=a-1;0<l;l--){var c=l;for(c=l;1<=c&&!(Math.abs(h[c])<=1e-10*(Math.abs(u[c-1])+Math.abs(u[c])));c--);if(c!=l){for(var f=0;;){if(100<++f){n=!0;break}var _=(u[l-1]-u[l])/2,p=h[l]*h[l],m=Math.sqrt(_*_+p);_<0&&(m=-m);for(var g=u[c]-u[l]+p/(_+m),v=h[c+1],y=c;y<l;y++){var w=void 0,d=void 0;Math.abs(g)>=Math.abs(v)?d=(p=-v/g)*(w=1/Math.sqrt(p*p+1)):w=(p=-g/v)*(d=1/Math.sqrt(p*p+1)),p=((_=u[y]-u[y+1])*d+2*w*h[y+1])*d,u[y]-=p,u[y+1]+=p,c<y&&(h[y]=w*h[y]-d*v),h[y+1]+=d*(w*_-2*d*h[y+1]);for(var x=0;x<a;x++)g=o[x][y],v=o[x][y+1],o[x][y]=w*g-d*v,o[x][y+1]=d*g+w*v;y<l-1&&(g=h[y+1],v=-d*h[y+2],h[y+2]*=w)}if(Math.abs(h[l])<=1e-10*(Math.abs(u[l-1])+Math.abs(u[l])))break}if(n)break}}return function(t,r){for(var n=r.length,e=[],o=0;o<n;o++)e[o]={sigma:r[o],index:o};e.sort(function(t,r){return t.sigma===r.sigma?0:t.sigma<r.sigma?1:-1});for(var i=$.zeros(n),a=$.zeros(n),u=0;u<n;u++)a.matrix_array[u][u]=new A(e[u].sigma),i.matrix_array[u][e[u].index]=A.ONE;return{V:t.mul(i),D:a}}(new $(o),u)},M.doGramSchmidtOrthonormalization=function(t){for(var r=$._toMatrix(t),n=r.column_length,e=r.matrix_array,o=$.zeros(n),i=$.zeros(n),a=o.matrix_array,u=i.matrix_array,h=[],s=new Array(n),l=0;l<n;l++){for(var c=0;c<n;c++)s[c]=e[c][l];if(0<l){for(var f=0;f<l;f++)for(var _=0;_<n;_++)u[f][l]=u[f][l].add(e[_][l].dot(a[_][f]));for(var p=0;p<l;p++)for(var m=0;m<n;m++)s[m]=s[m].sub(u[p][l].mul(a[m][p]))}for(var g=0;g<n;g++)u[l][l]=u[l][l].add(s[g].square());if(u[l][l]=u[l][l].sqrt(),u[l][l].isZero(1e-10)){h.push(l);for(var v=0;v<n;v++)a[v][l]=A.ZERO}else for(var y=0;y<n;y++)a[y][l]=s[y].div(u[l][l])}return{Q:o,R:i,non_orthogonalized:h}},M.createOrthogonalVector=function(t,r){for(var n=new $(t),e=n.column_length,o=n.matrix_array,i=M.getLinearDependenceVector(n,r||1e-10),a=i.length-1;0<=a;a--)o.splice(i[a],1),n.row_length--;var u=e-o.length;if(u<=0)return null;for(var h=new v(0),s=null,l=0;l<100;l++){var c=n.T(),f=$.createMatrixDoEachCalculation(function(){return new A(h.nextGaussian())},c.row_length,u);if(c._concatRight(f),0===(s=M.doGramSchmidtOrthonormalization(c)).non_orthogonalized.length)break}if(0!==s.non_orthogonalized.length)return console.log("miss"),null;for(var _=new Array(u),p=s.Q.matrix_array,m=0;m<u;m++){_[m]=new Array(e);for(var g=0;g<e;g++)_[m][g]=p[g][e-u+m]}return new $(_)},M.getMaxRowNumber=function(t,r,n,e){for(var o=$._toMatrix(t),i=0,a=0,u=n||0,h=e||o.row_length;u<h;u++){var s=o.matrix_array[u][r].norm();a<s&&(a=s,i=u)}return{index:i,max:a}},M.getLinearDependenceVector=function(t,r){for(var n=new $(t),e=n.matrix_array,o=r?$._toDouble(r):1e-10,i=new Array(n.row_length),a=0;a<n.row_length;a++)i[a]=a;for(var u=0;u<n.column_length;u++){var h=0,s=0,l=0;for(var c in i){var f=i[c],_=e[f][u].norm();s<_&&(s=_,l=parseInt(c,10),h=f)}if(!(s<=o)){if(i.splice(l,1),u===n.column_length-1)break;for(var p in i)for(var m=i[p],g=e[m][u].div(e[h][u]),v=u;v<n.column_length;v++)e[m][v]=e[m][v].sub(e[h][v].mul(g))}}return i};function c(){}c.inner=function(t,r,n){var e=$._toMatrix(t),o=$._toMatrix(r),i=e.matrix_array,a=o.matrix_array,u=n?$._toInteger(n):1;if(e.isScalar()&&o.isScalar())return new $(e.scalar().dot(o.scalar()));if(e.isVector()&&o.isVector()){for(var h=A.ZERO,s=0;s<e.length();s++)h=h.add(e.getComplex(s).dot(o.getComplex(s)));return new $(h)}if(e.row_length!==o.row_length||e.column_length!==o.column_length)throw"Matrix size does not match";if(1===u){var l=new Array(1);l[0]=new Array(e.column_length);for(var c=0;c<e.column_length;c++){for(var f=A.ZERO,_=0;_<e.row_length;_++)f=f.add(i[_][c].dot(a[_][c]));l[0][c]=f}return new $(l)}if(2!==u)throw"dim";for(var p=new Array(e.row_length),m=0;m<e.row_length;m++){for(var g=A.ZERO,v=0;v<e.column_length;v++)g=g.add(i[m][v].dot(a[m][v]));p[m]=[g]}return new $(p)},c.norm=function(t,r){var n=$._toMatrix(t),e=void 0===r?2:$._toDouble(r);if(1===e){var o=n.matrix_array;if(n.isRow()){for(var i=0,a=0;a<n.column_length;a++)i+=o[0][a].norm();return i}if(n.isColumn()){for(var u=0,h=0;h<n.row_length;h++)u+=o[h][0].norm();return u}for(var s=0,l=0;l<n.column_length;l++){for(var c=0,f=0;f<n.row_length;f++)c+=o[f][l].norm();s<c&&(s=c)}return s}if(2===e){var _=n.matrix_array;if(n.isRow()){for(var p=0,m=0;m<n.column_length;m++)p+=_[0][m].square().real();return Math.sqrt(p)}if(n.isColumn()){for(var g=0,v=0;v<n.row_length;v++)g+=_[v][0].square().real();return Math.sqrt(g)}return n.svd().S.diag().max().scalar().real()}if(e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY){var y=n.matrix_array,w=e===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,d=e===Number.POSITIVE_INFINITY?Math.max:Math.min;if(n.isRow()){for(var x=0;x<n.column_length;x++)w=d(w,y[0][x].norm());return w}if(n.isColumn()){for(var M=0;M<n.row_length;M++)w=d(w,y[M][0].norm());return w}for(var b=w=0;b<n.row_length;b++){for(var N=0,E=0;E<n.column_length;E++)N+=y[b][E].norm();w=Math.max(w,N)}return w}if(n.isVector()){for(var I=0,D=0;D<n.length();D++)I+=Math.pow(n.getComplex(D).norm(),e);return Math.pow(I,1/e)}throw"norm"},c.cond=function(t,r){var n=$._toMatrix(t);if(2!==(void 0===r?2:$._toInteger(r)))return n.norm(r)*n.pinv().norm(r);if(n.isZeros())return Number.POSITIVE_INFINITY;if(n.isVector())return 1;if(n.isUnitary())return 1;var e=n.svd().S.diag();return e.max().scalar().real()/e.min().scalar().real()},c.rcond=function(t){return 1/c.cond($._toMatrix(t),1)},c.rank=function(t,r){var n=$._toMatrix(t),e=void 0!==r?$._toDouble(r):void 0;return n.row_length<=n.column_length?Math.min(n.row_length,n.column_length)-M.getLinearDependenceVector(n,e).length:n.row_length-M.getLinearDependenceVector(n,e).length},c.trace=function(t){for(var r=$._toMatrix(t),n=Math.min(r.row_length,r.column_length),e=A.ZERO,o=0;o<n;o++)e=e.add(r.matrix_array[o][o]);return e},c.det=function(t){var r=$._toMatrix(t);if(!r.isSquare())throw"not square";var n=r.length();if(n<5){var s=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var r=A.ZERO,n=0;n<t.length;n++){for(var e=[],o=t[n][0],i=0,a=0;i<t.length;i++)if(n!==i){e[a]=[];for(var u=1,h=0;u<t.length;u++,h++)e[a][h]=t[i][u];a++}r=n%2==0?r.add(o.mul(s(e))):r.sub(o.mul(s(e)))}return r};return new $(s(r.matrix_array))}var e=c.lup(r),o=(n-e.P.diag().sum().scalar().real())/2,i=e.U.diag().prod();return o%2==1&&(i=i.negate()),new $(i)},c.lup=function(t){for(var r=new $(t),n=$.zeros(r.row_length),e=r,o=$.eye(r.row_length),i=n.matrix_array,a=e.matrix_array,u=0;u<r.column_length;u++){var h,s=M.getMaxRowNumber(e,u,u);if(h=s.index,0!==s.max){u!==h&&(n._exchangeRow(u,h),e._exchangeRow(u,h),o._exchangeRow(u,h));for(var l=u+1;l<r.row_length;l++){var c=a[l][u].div(a[u][u]);i[l][u]=c;for(var f=u;f<r.column_length;f++)a[l][f]=a[l][f].sub(a[u][f].mul(c))}}}return n._resize(r.row_length,Math.min(r.row_length,r.column_length)),e._resize(Math.min(r.row_length,r.column_length),r.column_length),n._each(function(t,r,n){return r===n?A.ONE:t}),{L:n,U:e,P:o}},c.lu=function(t){var r=c.lup(t);return{L:r.P.T().mul(r.L),U:r.U}},c.linsolve=function(t,r){var n=$._toMatrix(t),e=$._toMatrix(r);if(!n.isSquare())throw"Matrix size does not match";var o=e;if(e.row_length!==n.row_length||1<e.column_length)throw"Matrix size does not match";var i=new $(n);i._concatRight(o);for(var a=i.matrix_array,u=i.column_length,h=n.column_length,s=0;s<h-1;s++){var l=M.getMaxRowNumber(i,s,s).index;i._exchangeRow(s,l);for(var c=a[s][s].inv(),f=s,_=s;_<u;_++)a[f][_]=a[f][_].mul(c);for(var p=s+1;p<h;p++)for(var m=a[p][s],g=s;g<u;g++)a[p][g]=a[p][g].sub(a[s][g].mul(m))}var v=new Array(h);v[h-1]=a[h-1][h].div(a[h-1][h-1]);for(var y=h-2;0<=y;y--){v[y]=a[y][u-1];for(var w=y+1;w<h;w++)v[y]=v[y].sub(a[y][w].mul(v[w]));v[y]=v[y].div(a[y][y])}for(var d=new Array(n.row_length),x=0;x<n.row_length;x++)d[x]=[v[x]];return new $(d)},c.qr=function(t){var r=new $(t),n=r.row_length,e=r.row_length,o=r.row_length,i=r.column_length,a=Math.max(r.row_length,r.column_length);r._resize(a,a);var u=M.doGramSchmidtOrthonormalization(r),h=u.Q,s=u.R,l=u.non_orthogonalized;if(l.length===r.row_length)h=$.eye(r.row_length);else if(0!==l.length){for(var c={},f=0;f<l.length;f++)c[l[f]]=1;for(var _=[],p=0;p<a;p++)if(!c[p]){for(var m=[],g=0;g<a;g++)m[g]=h.matrix_array[g][p];_.push(m)}for(var v=M.createOrthogonalVector(_),y=0;y<l.length;y++)for(var w=l[y],d=0;d<a;d++)h.matrix_array[d][w]=v.matrix_array[y][d]}return h._resize(n,e),s._resize(o,i),{Q:h,R:s}},c.tridiagonalize=function(t){var r=new $(t);if(!r.isSquare())throw"not square matrix";if(!r.isSymmetric())throw"not Symmetric";if(r.isComplex())throw"not Real Matrix";return M.tridiagonalize(r)},c.eig=function(t){var r=new $(t);if(!r.isSquare())throw"not square matrix";if(!r.isSymmetric())throw"not Symmetric";if(r.isComplex())throw"not Real Matrix";return M.eig(r)},c.svd=function(t){var r=new $(t);if(r.isComplex())throw"Unimplemented";var e=c.rank(r),o=c.eig(r.T().mul(r)),i=$.zeros(r.row_length,r.column_length);i._each(function(t,r,n){if(r===n&&r<e)return o.D.getComplex(r,r).sqrt()});var n=Math.min(r.row_length,r.column_length),a=$.createMatrixDoEachCalculation(function(t,r){if(t!==r)return A.ZERO;var n=i.matrix_array[t][t];return n.isZero()?A.ZERO:n.inv()},n),u=o.V.resize(o.V.row_length,n),h=r.mul(u).mul(a);return{U:c.qr(h).Q,S:i,V:o.V}},c.inv=function(t){var r=new $(t);if(r.isScalar())return new $(A.ONE.div(r.scalar()));if(!r.isSquare())throw"not square";if(r.isDiagonal()){for(var n=r.T(),e=Math.min(n.row_length,n.column_length),o=0;o<e;o++)n.matrix_array[o][o]=n.matrix_array[o][o].inv();return n}var i=r.column_length,a=new $(r);a._concatRight($.eye(i));for(var u=a.matrix_array,h=a.column_length,s=0;s<i;s++){var l=M.getMaxRowNumber(a,s,s).index;a._exchangeRow(s,l);for(var c=u[s][s].inv(),f=s,_=s;_<h;_++)u[f][_]=u[f][_].mul(c);for(var p=0;p<i;p++)if(p!==s)for(var m=u[p][s],g=s;g<h;g++)u[p][g]=u[p][g].sub(u[s][g].mul(m))}for(var v=new Array(i),y=0;y<i;y++){v[y]=new Array(i);for(var w=0;w<i;w++)v[y][w]=u[y][i+w]}return new $(v)},c.pinv=function(t){var r=new $(t),n=c.svd(r),e=n.U,o=n.S,i=n.V,a=$.createMatrixDoEachCalculation(function(t,r){if(t!==r)return A.ZERO;var n=o.matrix_array[t][t];return n.isZero()?A.ZERO:n.inv()},r.column_length,r.row_length);return i.mul(a).mul(e.T())};function N(){}N.max=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=t[0],n=1;n<t.length;n++)r.compareTo(t[n])<0&&(r=t[n]);return[r]},e)},N.min=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=t[0],n=1;n<t.length;n++)0<r.compareTo(t[n])&&(r=t[n]);return[r]},e)},N.sum=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=A.ZERO,n=A.ZERO,e=0;e<t.length;e++){var o=t[e].add(n),i=r.add(o);n=i.sub(r).sub(o),r=i}return[r]},e)},N.mean=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=A.ZERO,n=A.ZERO,e=0;e<t.length;e++){var o=t[e].add(n),i=r.add(o);n=i.sub(r).sub(o),r=i}return[r.div(t.length)]},e)},N.prod=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=A.ONE,n=0;n<t.length;n++)r=r.mul(t[n]);return[r]},e)},N.geomean=function(t,r){var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){for(var r=A.ONE,n=0;n<t.length;n++)r=r.mul(t[n]);return[r.pow(A.create(t.length).inv())]},e)},N.median=function(t,r){function o(t,r){return t.compareTo(r)}var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){var r;if(t.sort(o),t.length%2==1)r=t[Math.floor(t.length/2)];else{var n=t[Math.floor(t.length/2)-1],e=t[Math.floor(t.length/2)];r=n.add(e).div(A.TWO)}return[r]},e)},N.mode=function(t,r){function h(t,r){return t.compareTo(r)}var n=$._toMatrix(t),e=r&&r.dimension?r.dimension:"auto";return n.eachVector(function(t){t.sort(h);for(var r={},n=0;n<t.length;n++){var e=t[n].real+" "+t[n].imag;r[e]?r[e].value++:r[e]={complex:t[n],value:1}}var o=A.ZERO,i=Number.NEGATIVE_INFINITY;for(var a in r){var u=r[a];u.value>i&&(i=u.value,o=u.complex)}return[o]},e)},N.moment=function(t,r,n){var e=$._toMatrix(t),i=N.mean(e),a=n&&"number"==typeof n.correction?$._toDouble(n.correction):1,o=n&&n.dimension?n.dimension:"auto",u=$._toComplex(r),h=0;return e.eachVector(function(t){var r;r=i.isScalar()?i.scalar():i.getComplex(h++);for(var n=A.ZERO,e=0;e<t.length;e++){var o=t[e].sub(r);n=n.add(o.pow(u))}return 1===t.length?[n.div(t.length)]:[n.div(t.length-1+a)]},o)},N.variance=function(t,r){var n=$._toMatrix(t),i=N.mean(n),a=r&&"number"==typeof r.correction?$._toDouble(r.correction):0,e=r&&r.dimension?r.dimension:"auto",u=0;return n.eachVector(function(t){if(1===t.length)return[A.ZERO];for(var r=i.getComplex(u++),n=0,e=0;e<t.length;e++){var o=t[e].sub(r).norm();n+=o*o}return[A.create(n/(t.length-1+a))]},e)},N.std=function(t,r){var n=$._toMatrix(t),e=r&&"number"==typeof r.correction?$._toDouble(r.correction):0,o=r&&r.dimension?r.dimension:"auto",i=N.variance(n,{correction:e,dimension:o});return i._each(function(t){return t.sqrt()}),i},N.mad=function(t,r,n){var e=$._toMatrix(t),o=r?"string"==typeof r?r:$._toInteger(r):"mean",i=n&&n.dimension?n.dimension:"auto";if("mean"===o||0===o)return N.mean(e.sub(N.mean(e,{dimension:i})).abs(),{dimension:i});if("median"===o||1===o)return N.median(e.sub(N.median(e,{dimension:i})).abs(),{dimension:i});throw"mad unsupported argument "+o},N.skewness=function(t,r){var n=$._toMatrix(t),e=r&&"number"==typeof r.correction?$._toDouble(r.correction):1,o=r&&r.dimension?r.dimension:"auto",i=N.moment(n,3,{correction:e,dimension:o}),a=N.std(n,{correction:e,dimension:o});return 1===e?i.dotdiv(a.dotpow(3)):i.dotdiv(a.dotpow(3)).dotmul(2)},N.cov=function(t,r,n){var e=$._toMatrix(t),o=0,i=null;if(void 0!==r&&(void 0!==n?(o=n&&"number"==typeof n.correction?$._toDouble(n.correction):0,i=$._toMatrix(r)):"object"==typeof r&&"correction"in r?o=$._toDouble(r.correction):i=$._toMatrix(r)),null===i){if(e.isVector())return N.variance(e,{correction:o});for(var a=1===e.row_length?1:o,u=e.matrix_array,h=N.mean(e).matrix_array[0],s=new Array(e.column_length),l=0;l<e.column_length;l++){var c=h[l];s[l]=new Array(e.column_length);for(var f=l;f<e.column_length;f++){for(var _=h[f],p=A.ZERO,m=0;m<e.row_length;m++)p=p.add(u[m][l].sub(c).dot(u[m][f].sub(_)));s[l][f]=p.div(e.row_length-1+a)}}for(var g=1;g<s[0].length;g++)for(var v=0;v<g;v++)s[g][v]=s[v][g];return new $(s)}if(!e.isVector()&&!i.isVector())throw"vector not specified";if(e.length()!==i.length())throw"X.length !== Y.length";for(var y=N.mean(e).scalar(),w=N.mean(i).scalar(),d=e.length(),x=1===d?1:o,M=A.ZERO,b=0;b<d;b++)M=M.add(e.getComplex(b).sub(y).dot(i.getComplex(b).sub(w)));return new $(M.div(d-1+x))},N.standardization=function(t,r){var n=$._toMatrix(t),e=n.sub(N.mean(n,r));return e.dotdiv(N.std(e,r))},N.corrcoef=function(t,r,n){var e=$._toMatrix(t),o=null;if(void 0!==r&&(void 0!==n?o=$._toMatrix(r):"object"==typeof r&&"correction"in r||(o=$._toMatrix(r))),null===o)return N.cov(N.standardization(e,n),n);if(!e.isVector()&&!o.isVector())throw"vector not specified";if(e.length()!==o.length())throw"X.length["+e.length()+"] !== Y.length["+o.length()+"]";var i=N.cov(e,o,n),a=e.std(n),u=o.std(n);return i.div(a.mul(u))},N.sort=function(t,r,n){var e,o=$._toMatrix(t),i=n&&n.dimension?n.dimension:"auto";e="ascend"===(r||"ascend")?function(t,r){return t.compareTo(r)}:function(t,r){return r.compareTo(t)};return o.eachVector(function(t){return t.sort(e),t},i)};function u(t){this.size=t,this.inv_size=1/this.size,this.bit_size=Math.round(Math.log(this.size)/Math.log(2)),this.is_fast=1<<this.bit_size===this.size,this.bitrv=null,this.fft_re=new Array(this.size),this.fft_im=new Array(this.size);for(var r=-2*Math.PI/this.size,n=0,e=0,o=0;e<this.size;e++){this.fft_re[e]=Math.cos(o),this.fft_im[e]=Math.sin(o);var i=r+n,a=o+i;n=a-o-i,o=a}this.is_fast&&(this.bitrv=u.create_bit_reverse_table(this.bit_size))}u.bit_reverse_32=function(t){var r=4294967295&t;return r=(65535&(r=(16711935&(r=(252645135&(r=(858993459&(r=(1431655765&r)<<1|r>>1&1431655765))<<2|r>>2&858993459))<<4|r>>4&252645135))<<8|r>>8&16711935))<<16|r>>16&65535},u.create_bit_reverse_table=function(t){for(var r=1<<t,n=[],e=0;e<r;e++)n[e]=u.bit_reverse_32(e)>>>32-t;return n},u.prototype.free=function(){delete this.size,delete this.inv_size,delete this.bit_size,delete this.is_fast,delete this.bitrv,delete this.fft_re,delete this.fft_im},u.prototype.fft=function(t,r){var n=new Array(this.size),e=new Array(this.size);if(this.is_fast){for(var o=0;o<this.size;o++)n[o]=t[this.bitrv[o]],e[o]=r[this.bitrv[o]];for(var i=1,a=this.size/2,u=2,h=1<<this.bit_size-1;0<h;h>>=1){for(var s=0;s<a;s++)for(var l=s*u,c=0,f=0;c<i;c++,l++,f+=h){var _=n[l+i]*this.fft_re[f]-e[l+i]*this.fft_im[f],p=e[l+i]*this.fft_re[f]+n[l+i]*this.fft_im[f];n[l+i]=n[l]-_,e[l+i]=e[l]-p,n[l]+=_,e[l]+=p}a/=2,u*=2,i*=2}}else if(U.isContainsZero(r))for(var m=0;m<this.size;m++){n[m]=0;for(var g=e[m]=0,v=0;g<this.size;v=++g*m%this.size)n[m]+=t[g]*this.fft_re[v]-r[g]*this.fft_im[v],e[m]+=t[g]*this.fft_im[v]+r[g]*this.fft_re[v]}else for(var y=0;y<this.size;y++){n[y]=0;for(var w=e[y]=0,d=0;w<this.size;d=++w*y%this.size)n[y]+=t[w]*this.fft_re[d],e[y]+=t[w]*this.fft_im[d]}return{real:n,imag:e}},u.prototype.ifft=function(t,r){var n=new Array(this.size),e=new Array(this.size);if(this.is_fast){for(var o=0;o<this.size;o++)n[o]=t[this.bitrv[o]],e[o]=r[this.bitrv[o]];for(var i,a,u=1,h=this.size/2,s=2,l=1<<this.bit_size-1;0<l;l>>=1){for(var c=0;c<h;c++)for(var f=c*s,_=0,p=0;_<u;_++,f++,p+=l)i=n[f+u]*this.fft_re[p]+e[f+u]*this.fft_im[p],a=e[f+u]*this.fft_re[p]-n[f+u]*this.fft_im[p],n[f+u]=n[f]-i,e[f+u]=e[f]-a,n[f]+=i,e[f]+=a;h/=2,s*=2,u*=2}}else if(U.isContainsZero(r))for(var m=0;m<this.size;m++){n[m]=0;for(var g=e[m]=0,v=0;g<this.size;v=m*++g%this.size)n[m]+=t[g]*this.fft_re[v]+r[g]*this.fft_im[v],e[m]+=-t[g]*this.fft_im[v]+r[g]*this.fft_re[v]}else for(var y=0;y<this.size;y++){n[y]=0;for(var w=e[y]=0,d=0;w<this.size;d=y*++w%this.size)n[y]+=t[w]*this.fft_re[d],e[y]+=-t[w]*this.fft_im[d]}for(var x=0;x<this.size;x++)n[x]*=this.inv_size,e[x]*=this.inv_size;return{real:n,imag:e}};function h(t,r){this.object=t,this.table=[],this.table_max=r}h.prototype.get=function(t){for(var r=0;r<this.table.length;r++)if(this.table[r].size===t){var n=this.table.splice(r,1)[0];return this.table.unshift(n),n}var e=new this.object(t);this.table.length===this.table_max&&this.table.pop().free();return this.table.unshift(e),e};function s(t){this.size=t,this.dct_size=2*t,this.dct_re=new Array(this.size),this.dct_im=new Array(this.size);for(var r=1/Math.sqrt(this.size),n=r*Math.sqrt(2),e=0;e<this.size;e++){var o=-Math.PI*e/this.dct_size;this.dct_re[e]=Math.cos(o)*(0===e?r:n),this.dct_im[e]=Math.sin(o)*(0===e?r:n)}}var f=new h(u,4);s.prototype.free=function(){delete this.size,delete this.dct_size,delete this.dct_re,delete this.dct_im},s.prototype.dct=function(t){for(var r=new Array(this.dct_size),n=new Array(this.dct_size),e=0;e<this.dct_size;e++)r[e]=e<this.size?t[e]:0,n[e]=0;for(var o=f.get(this.dct_size).fft(r,n),i=0;i<this.size;i++)r[i]=o.real[i]*this.dct_re[i]-o.imag[i]*this.dct_im[i];return r.splice(this.size),r},s.prototype.idct=function(t){for(var r=new Array(this.dct_size),n=new Array(this.dct_size),e=2*this.size,o=0;o<this.dct_size;o++)r[o]=o<this.size?e*t[o]*this.dct_re[o]:0,n[o]=o<this.size?e*t[o]*-this.dct_im[o]:0;var i=f.get(this.dct_size).ifft(r,n);return i.real.splice(this.size),i.real};var _=new h(s,4),U=function(){};U.isContainsZero=function(t){for(var r=0;r<t.length;r++)if(0!==t[r])return!0;return!1},U.fft=function(t,r){return f.get(t.length).fft(t,r)},U.ifft=function(t,r){return f.get(t.length).ifft(t,r)},U.dct=function(t){return _.get(t.length).dct(t)},U.idct=function(t){return _.get(t.length).idct(t)},U.powerfft=function(t,r){for(var n=t.length,e=U.fft(t,r),o=new Array(n),i=0;i<n;i++)o[i]=e.real[i]*e.real[i]+e.imag[i]*e.imag[i];return o},U.conv=function(t,r,n,e){var o=!1;if(t.length===n.length){o=!0;for(var i=0;i<t.length;i++)if(t[i]!==n[i]||r[i]!==e[i]){o=!1;break}}var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){if(o){for(var h=t.length,s=new Array(u),l=new Array(u),c=0;c<u;c++)s[c]=c<h?t[c]:0,l[c]=c<h?r[c]:0;for(var f=U.fft(s,l),_=0;_<u;_++)s[_]=f.real[_]*f.real[_]-f.imag[_]*f.imag[_],l[_]=f.real[_]*f.imag[_]+f.imag[_]*f.real[_];var p=U.ifft(s,l);return p.real.splice(u-1),p.imag.splice(u-1),p}if(t.length===n.length){for(var m=t.length,g=new Array(u),v=new Array(u),y=new Array(u),w=new Array(u),d=0;d<u;d++)g[d]=d<m?t[d]:0,v[d]=d<m?r[d]:0,y[d]=d<m?n[d]:0,w[d]=d<m?e[d]:0;for(var x=U.fft(g,v),M=U.fft(y,w),b=new Array(u),N=new Array(u),E=0;E<u;E++)b[E]=x.real[E]*M.real[E]-x.imag[E]*M.imag[E],N[E]=x.real[E]*M.imag[E]+x.imag[E]*M.real[E];var I=U.ifft(b,N);return I.real.splice(u-1),I.imag.splice(u-1),I}}var D=!U.isContainsZero(r);D=D&&!U.isContainsZero(e);for(var C=new Array(t.length+n.length-1),A=new Array(t.length+n.length-1),O=0;O<C.length;O++)C[O]=0,A[O]=0;if(D)for(var S=0;S<n.length;S++)for(var R=0;R<t.length;R++)C[S+R]+=t[R]*n[S];else for(var T=0;T<n.length;T++)for(var z=0;z<t.length;z++)C[T+z]+=t[z]*n[T]-r[z]*e[T],A[T+z]+=t[z]*e[T]+r[z]*n[T];return{real:C,imag:A}},U.xcorr=function(t,r,n,e){var o=!1;if(t.length===n.length){o=!0;for(var i=0;i<t.length;i++)if(t[i]!==n[i]||r[i]!==e[i]){o=!1;break}}if(t.length===n.length){var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){var h=null;if(o){for(var s=new Array(u),l=new Array(u),c=0;c<u;c++)s[c]=c<a?t[c]:0,l[c]=c<a?r[c]:0;var f=U.powerfft(s,l);h=U.ifft(f,l),s.pop(),l.pop();for(var _=0,p=a+1;_<s.length;_++,p++)u<=p&&(p=0),s[_]=h.real[p],l[_]=h.imag[p];return{real:s,imag:l}}for(var m=new Array(u),g=new Array(u),v=new Array(u),y=new Array(u),w=0;w<u;w++)m[w]=w<a?t[w]:0,g[w]=w<a?r[w]:0,v[w]=w<a?n[a-w-1]:0,y[w]=w<a?-e[a-w-1]:0;for(var d=U.fft(m,g),x=U.fft(v,y),M=new Array(u),b=new Array(u),N=0;N<u;N++)M[N]=d.real[N]*x.real[N]-d.imag[N]*x.imag[N],b[N]=d.real[N]*x.imag[N]+d.imag[N]*x.real[N];return(h=U.ifft(M,b)).real.splice(u-1),h.imag.splice(u-1),h}}var E=!U.isContainsZero(r);if(E=E&&!U.isContainsZero(e),o){var I=t.length,D=2*I;if(E){for(var C=new Array(I),A=0;A<I;A++)for(var O=I-A,S=C[A]=0;S<O;S++)C[A]+=t[S]*n[S+A];for(var R=new Array(D-1),T=new Array(D-1),z=0,V=I-1;z<I;z++,V--)R[z]=C[V],R[I+z-1]=C[z];for(var P=0;P<T.length;P++)T[P]=0;return{real:R,imag:T}}}for(var F=new Array(n.length),q=new Array(n.length),Z=0;Z<n.length;Z++)F[Z]=n[n.length-Z-1],q[Z]=-e[n.length-Z-1];var L=U.conv(t,r,F,q);if(t.length===n.length)return L;for(var G=Math.abs(t.length-n.length),k=new Array(G),Y=0;Y<G;Y++)k[Y]=0;return t.length>n.length?{real:k.concat(L.real),imag:k.concat(L.imag)}:{real:L.real.concat(k),imag:L.imag.concat(k)}},U.window=function(t,r,n){var a,e=void 0!==n?n:"symmetric",o=t.toLocaleLowerCase(),u=r,h=new Array(u);"symmetric"===e||0===e?a=function(t){return t/(u-1)*(2*Math.PI)}:"periodic"!==e&&0===e||(a=function(t){return t/u*(2*Math.PI)});function i(t,r,n,e,o){for(var i=0;i<u;i++)h[i]=t,h[i]-=r*Math.cos(1*a(i)),h[i]+=n*Math.cos(2*a(i)),h[i]-=e*Math.cos(3*a(i)),h[i]+=o*Math.cos(4*a(i))}switch(o){case"rectangle":i(1,0,0,0,0);break;case"hann":i(.5,.5,0,0,0);break;case"hamming":i(.54,.46,0,0,0);break;case"blackman":i(.42,.5,.08,0,0);break;case"blackmanharris":i(.35875,.48829,.14128,.01168,0);break;case"blackmannuttall":i(.3635819,.4891775,.1365995,.0106411,0);break;case"flattop":i(1,1.93,1.29,.388,.032);break;case"sin":for(var s=0;s<u;s++)h[s]=Math.sin(.5*a(s));break;case"vorbis":for(var l=0;l<u;l++){var c=Math.sin(.5*a(l));h[l]=Math.sin(.5*Math.PI*c*c)}}return h},U.hann=function(t,r){return U.window("hann",t,r)},U.hamming=function(t,r){return U.window("hamming",t,r)};function p(){}p.fft=function(t,r){var n=r&&r.dimension?r.dimension:"auto";return $._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),n=new Array(t.length),e=0;e<t.length;e++)r[e]=t[e].real(),n[e]=t[e].imag();for(var o=U.fft(r,n),i=new Array(t.length),a=0;a<t.length;a++)i[a]=new A([o.real[a],o.imag[a]]);return i},n)},p.ifft=function(t,r){var n=r&&r.dimension?r.dimension:"auto";return $._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),n=new Array(t.length),e=0;e<t.length;e++)r[e]=t[e].real(),n[e]=t[e].imag();for(var o=U.ifft(r,n),i=new Array(t.length),a=0;a<t.length;a++)i[a]=new A([o.real[a],o.imag[a]]);return i},n)},p.powerfft=function(t,r){var n=r&&r.dimension?r.dimension:"auto";return $._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),n=new Array(t.length),e=0;e<t.length;e++)r[e]=t[e].real(),n[e]=t[e].imag();for(var o=U.powerfft(r,n),i=new Array(t.length),a=0;a<t.length;a++)i[a]=new A(o[a]);return i},n)},p.dct=function(t,r){var n=r&&r.dimension?r.dimension:"auto",e=$._toMatrix(t);if(e.isComplex())throw"dct don't support complex numbers.";return e.eachVector(function(t){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n].real();for(var e=U.dct(r),o=new Array(t.length),i=0;i<t.length;i++)o[i]=new A(e[i]);return o},n)},p.idct=function(t,r){var n=r&&r.dimension?r.dimension:"auto",e=$._toMatrix(t);if(e.isComplex())throw"idct don't support complex numbers.";return e.eachVector(function(t){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n].real();for(var e=U.idct(r),o=new Array(t.length),i=0;i<t.length;i++)o[i]=new A(e[i]);return o},n)},p.fft2=function(t){return p.fft(t,{dimension:"both"})},p.ifft2=function(t){return p.ifft(t,{dimension:"both"})},p.dct2=function(t){return p.dct(t,{dimension:"both"})},p.idct2=function(t){return p.idct(t,{dimension:"both"})},p.conv=function(t,r){var n=$._toMatrix(t),e=$._toMatrix(r);if(n.isMatrix()||e.isMatrix())throw"conv don't support matrix numbers.";var o=new Array(n.length()),i=new Array(n.length()),a=new Array(e.length()),u=new Array(e.length());if(n.isRow())for(var h=0;h<n.column_length;h++)o[h]=n.matrix_array[0][h].real(),i[h]=n.matrix_array[0][h].imag();else for(var s=0;s<n.row_length;s++)o[s]=n.matrix_array[s][0].real(),i[s]=n.matrix_array[s][0].imag();if(e.isRow())for(var l=0;l<e.column_length;l++)a[l]=e.matrix_array[0][l].real(),u[l]=e.matrix_array[0][l].imag();else for(var c=0;c<e.row_length;c++)a[c]=e.matrix_array[c][0].real(),u[c]=e.matrix_array[c][0].imag();for(var f=U.conv(o,i,a,u),_=new Array(f.real.length),p=0;p<f.real.length;p++)_[p]=new A([f.real[p],f.imag[p]]);var m=new $([_]);return e.isRow()?m:m.transpose()},p.xcorr=function(t,r){var n=$._toMatrix(t);if(!r)return n.xcorr(n);var e=$._toMatrix(r);if(n.isMatrix()||e.isMatrix())throw"conv don't support matrix numbers.";var o=new Array(n.length()),i=new Array(n.length()),a=new Array(e.length()),u=new Array(e.length());if(n.isRow())for(var h=0;h<n.column_length;h++)o[h]=n.matrix_array[0][h].real(),i[h]=n.matrix_array[0][h].imag();else for(var s=0;s<n.row_length;s++)o[s]=n.matrix_array[s][0].real(),i[s]=n.matrix_array[s][0].imag();if(e.isRow())for(var l=0;l<e.column_length;l++)a[l]=e.matrix_array[0][l].real(),u[l]=e.matrix_array[0][l].imag();else for(var c=0;c<e.row_length;c++)a[c]=e.matrix_array[c][0].real(),u[c]=e.matrix_array[c][0].imag();for(var f=U.xcorr(o,i,a,u),_=new Array(f.real.length),p=0;p<f.real.length;p++)_[p]=new A([f.real[p],f.imag[p]]);var m=new $([_]);return n.isRow()?m:m.transpose()},p.window=function(t,r,n){var e=$._toInteger(r),o=U.window(t,e,n);return new $(o).transpose()},p.hann=function(t,r){return p.window("hann",t,r)},p.hamming=function(t,r){return p.window("hamming",t,r)},p.fftshift=function(t,r){var n=$._toMatrix(t);if(n.isVector()){var e=Math.floor(n.length()/2);return n.circshift(e,r)}var o=Math.floor(n.column_length/2),i=Math.floor(n.row_length/2);if(void 0!==r){var a=r.dimension;if("row"===a||1===a)return n.circshift(o,r);if("column"===a||2===a)return n.circshift(i,r)}return n.circshift(o,{dimension:"row"}).circshift(i,{dimension:"column"})};function m(t){return!!t.isComplexData&&t.isComplexData()}function g(t){return!!t.isMatrixData&&t.isMatrixData()}function y(){}y.toPositionArrayFromObject=function(t,r,n){if("string"==typeof t){var e=y.toArrayFromString(t);if(":"===e){for(var o=new Array(r),i=0;i<r;i++)o[i]=i+n;return o}if(e instanceof Array){for(var a=e,u=new Array(a.length),h=0;h<a.length;h++)u[h]=Math.trunc(a[h].real());return u}throw"toArrayFromString["+t+"]["+e+"]"}var s=t;if(g(s)||m(s)||"number"==typeof s||(s=$._toMatrix(s)),g(s)){if(!s.isVector())throw"getMatrix argument "+s;var l=s.length(),c=new Array(s.length());if(s.isRow())for(var f=0;f<l;f++)c[f]=Math.trunc(s.matrix_array[0][f].real());else if(s.isColumn())for(var _=0;_<l;_++)c[_]=Math.trunc(s.matrix_array[_][0].real());return c}return[$._toInteger(s)]},y.match2=function(t,r){for(var n=[],e=t,o=0;o<1e3;o++){var i=e.match(r);if(null===i){e.length&&n.push([!1,e]);break}0<i.index&&n.push([!1,e.substr(0,i.index)]),n.push([!0,i[0]]),e=e.substr(i.index+i[0].length)}return n},y.trimBracket=function(t){var r=t,n=!1;if(/'$/.test(r)){var e=r.match(/(\s*')*$/g)[0];n=(e.split("'").length-1)%2==1,r=r.substring(0,r.length-e.length)}return/^\[/.test(r)&&/\]$/.test(r)?{text:r.substring(1,r.length-1),is_transpose:n}:null},y.toMatrixArrayFromStringForArrayJSON=function(t){var r=[],n=t.match(/\[[^\]]+\]/g);null===n&&(n=[t]);for(var e=0;e<n.length;e++){for(var o=n[e],i=o.substring(1,o.length-1).split(","),a=[],u=0;u<i.length;u++){var h=i[u];a[u]=new A(h)}r[e]=a}return r},y.InterpolationCalculation=function(t,r,n,e){var o=t.compareTo(n),i=void 0===e||e;if(0===o)return[t];if(r.isZero())throw"IllegalArgumentException";if(r.isNegative()&&-1===o)throw"IllegalArgumentException";var a=[],u=t;a[0]=u;for(var h=1;h<65536;h++){if(u=u.add(r),i){if(n.compareTo(u)===o)break}else if(0<=n.compareTo(u)*o)break;a[h]=u}return a},y.toArrayFromMatch2String=function(t){for(var r=t,n=[],e=0;e<r.length;e++){var o=r[e];if(o[0])if(e<r.length-2&&!r[e+1][0]&&/:/.test(r[e+1][1])){var i=void 0,a=void 0,u=void 0;e<r.length-4&&!r[e+3][0]&&/:/.test(r[e+3][1])?(i=new A(o[1]),a=new A(r[e+2][1]),u=new A(r[e+4][1]),e+=4):(i=new A(o[1]),a=A.ONE,u=new A(r[e+2][1]),e+=2);for(var h=y.InterpolationCalculation(i,a,u,!0),s=0;s<h.length;s++)n.push(h[s])}else n.push(new A(o[1]))}return n},y.toArrayFromString=function(t){if(":"===t.trim())return":";var r=t.toLowerCase().replace(/infinity|inf/g,"1e100000"),n=new RegExp("("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]( *[+] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan)))?/.source+")|("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))( *[+-] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij])?/.source+")","i");return y.toArrayFromMatch2String(y.match2(r,n))},y.toMatrixArrayFromStringForArraySPACE=function(t){for(var r=t.split(";"),n=new Array(r.length),e=0;e<r.length;e++)n[e]=y.toArrayFromString(r[e]);return n},y.toMatrixArrayFromStringInBracket=function(t){return/[[\]]/.test(t)?y.toMatrixArrayFromStringForArrayJSON(t):y.toMatrixArrayFromStringForArraySPACE(t)},y.toMatrixArrayFromString=function(t){var r=t.replace(/^\s*|\s*$/g,""),n=y.trimBracket(r);if(n){var e=y.toMatrixArrayFromStringInBracket(n.text);return n.is_transpose&&(e=new $(e).T().matrix_array),e}return/[;,]|[0-9]\s+[0-9]/.test(t)?y.toMatrixArrayFromStringInBracket(t.replace(/[[\]]/g,"").replace(/,/g," ")):[[new A(t)]]},y.isCorrectMatrixArray=function(t){if(0===t.length)return!1;var r=t[0].length;if(0===r)return!1;for(var n=1;n<t.length;n++)if(t[n].length!==r)return!1;return!0};var $=function(t){var r=null,n=!1;if(1!==arguments.length)throw"Matrix : Many arguments ["+arguments.length+"]";var e=t;if(g(e)){r=new Array(e.row_length);for(var o=0;o<e.row_length;o++){r[o]=new Array(e.column_length);for(var i=0;i<e.column_length;i++)r[o][i]=e.matrix_array[o][i]}}else if(m(e))r=[[e]];else if(e instanceof Array){r=[];for(var a=0;a<e.length;a++){var u=e[a];if(u instanceof Array){for(var h=new Array(u.length),s=0;s<u.length;s++){var l=u[s];if(m(l))h[s]=l;else if(g(l)){if(!l.isScalar())throw"Matrix in matrix";h[s]=l.scalar()}else h[s]=new A(l)}r[a]=h}else if(0===a&&(r[0]=new Array(e.length)),m(u))r[0][a]=u;else if(g(u)){if(!u.isScalar())throw"Matrix in matrix";r[0][a]=u.scalar()}else r[0][a]=new A(u)}}else r="string"==typeof e?(n=!0,y.toMatrixArrayFromString(e)):e instanceof Object?(n=!0,y.toMatrixArrayFromString(e.toString())):[[new A(e)]];if(n)for(var c=0;c<r.length;c++)":"===r[c]&&r.splice(c--,1);if(!y.isCorrectMatrixArray(r))throw console.log(r),"new Matrix IllegalArgumentException";this.matrix_array=r,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null};$.create=function(t){return 1===arguments.length&&g(t)?t:new $(t)},$.valueOf=function(t){return $.create(t)},$._toMatrix=function(t){return g(t)?t:new $(t)},$._toComplex=function(t){if(m(t))return t;var r=$._toMatrix(t);if(r.isScalar())return r.scalar();throw"not scalar. ["+t+"]"},$._toDouble=function(t){if("number"==typeof t)return t;var r=$._toComplex(t);if(r.isReal())return r.real();throw"not support complex numbers."},$._toInteger=function(t){return Math.trunc($._toDouble(t))},$.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},$.prototype.clone=function(){return new $(this.matrix_array)},$.prototype.toString=function(){if(this.string_cash)return this.string_cash;if(this.isScalar())return this.scalar().toString();var e=Math.pow(10,9),i=!1,o=!1,a=0;this._each(function(t,r,n){t.isReal()||(i=!0),Number.isFinite(t.real())&&Math.abs(t.real())>=e&&(o=!0),Number.isFinite(t.imag())&&Math.abs(t.imag())>=e&&(o=!0),a=Math.max(a,t.getDecimalPosition())}),0<a&&(a=4);function u(t){var r=o?t.toExponential(4):t.toFixed(a);if(/inf/i.test(r))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(r))return"NaN";if(!o)return r;var n=r.split("e"),e=n[1];return 2===e.length?e=e.substr(0,1)+"00"+e.substr(1):3===e.length&&(e=e.substr(0,1)+"0"+e.substr(1)),n[0]+"e"+e}var h=0,s=[];this._each(function(t){var r={},n=t.real();if(r.re_sign=n<0?"-":" ",n=Math.abs(n),r.re_str=u(n),h=Math.max(h,r.re_str.length+1),i){var e=t.imag();r.im_sign=e<0?"-":"+",e=Math.abs(e),r.im_str=u(e),h=Math.max(h,r.im_str.length+1)}s.push(r)});function l(t,r){return"                                        ".substr(0,r-t.length)+t}var c=[],f=this;return this._each(function(t,r,n){var e=s.shift(),o=l(e.re_sign+e.re_str,h);i&&(o+=" "+e.im_sign+l(e.im_str,h)+"i"),c.push(o),c.push(n<f.column_length-1?" ":"\n")}),this.string_cash=c.join(""),this.string_cash},$.prototype.toOneLineString=function(){if(this.isScalar())return this.scalar().toString();for(var t="[ ",r=0;r<this.row_length;r++)for(var n=0;n<this.column_length;n++)t+=this.matrix_array[r][n].toString(),n<this.column_length-1?t+=", ":r<this.row_length-1&&(t+="; ");return t+=" ]"},$.prototype.toJSON=function(){if(this.isScalar())return this.scalar().toJSON();for(var t="[",r=0;r<this.row_length;r++)for(var n=0;n<this.column_length;n++)t+=this.matrix_array[r][n].toJSON(),n<this.column_length-1?t+=",":r<this.row_length-1&&(t+=";");return t+="]"},$.prototype.equals=function(t,r){var n=this,e=$._toMatrix(t);if(n.row_length!==e.row_length||n.column_length!==e.column_length)return!1;if(1===n.row_length&&1===n.column_length)return n.scalar().equals(e.scalar(),r);for(var o=n.matrix_array,i=e.matrix_array,a=0;a<this.row_length;a++)for(var u=0;u<this.column_length;u++)if(!o[a][u].equals(i[a][u],r))return!1;return!0},$.prototype.getNumberMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var n=0;n<this.column_length;n++)t[r][n]=this.matrix_array[r][n].real()}return t},$.prototype.getComplexMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var n=0;n<this.column_length;n++)t[r][n]=this.matrix_array[r][n]}return t},$.prototype._each=function(t){for(var r=!1,n=0;n<this.row_length;n++)for(var e=0;e<this.column_length;e++){var o=t(this.matrix_array[n][e],n,e);void 0!==o&&(m(o)?this.matrix_array[n][e]=o:g(o)?this.matrix_array[n][e]=o.scalar():this.matrix_array[n][e]=new A(o),r=!0)}return r&&this._clearCash(),this},$.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},$.createMatrixDoEachCalculation=function(t,r,n){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var e=$._toInteger(r),o=n?$._toInteger(n):e,i=new Array(e),a=0;a<e;a++){i[a]=new Array(o);for(var u=0;u<o;u++){var h=t(a,u);i[a][u]=void 0===h?A.ZERO:$._toComplex(h)}}return new $(i)},$.prototype.eachVectorAuto=function(t){if(this.isRow()){for(var r=new Array(this.row_length),n=0;n<this.column_length;n++)r[n]=this.matrix_array[0][n];return new $(t(r))}var e=$.ZERO.clone();e._resize(1,this.column_length);for(var o=0;o<this.column_length;o++){for(var i=new Array(this.row_length),a=0;a<this.row_length;a++)i[a]=this.matrix_array[a][o];var u=t(i);e._resize(Math.max(e.row_length,u.length),e.column_length);for(var h=0;h<u.length;h++)e.matrix_array[h][o]=u[h]}return e},$.prototype.eachVectorBoth=function(t){var r=$.ZERO.clone();r._resize(this.row_length,1);for(var n=0;n<this.row_length;n++){for(var e=new Array(this.column_length),o=0;o<this.column_length;o++)e[o]=this.matrix_array[n][o];var i=t(e);r._resize(r.row_length,Math.max(r.column_length,i.length));for(var a=0;a<i.length;a++)r.matrix_array[n][a]=i[a]}var u=$.ZERO.clone();u._resize(1,r.column_length);for(var h=0;h<r.column_length;h++){for(var s=new Array(r.row_length),l=0;l<r.row_length;l++)s[l]=r.matrix_array[l][h];var c=t(s);u._resize(Math.max(u.row_length,c.length),u.column_length);for(var f=0;f<c.length;f++)u.matrix_array[f][h]=c[f]}return u},$.prototype.eachVectorRow=function(t){var r=$.ZERO.clone();r._resize(this.row_length,1);for(var n=0;n<this.row_length;n++){for(var e=new Array(this.column_length),o=0;o<this.column_length;o++)e[o]=this.matrix_array[n][o];var i=t(e);r._resize(r.row_length,Math.max(r.column_length,i.length));for(var a=0;a<i.length;a++)r.matrix_array[n][a]=i[a]}return r},$.prototype.eachVectorColumn=function(t){var r=$.ZERO.clone();r._resize(1,this.column_length);for(var n=0;n<this.column_length;n++){for(var e=new Array(this.row_length),o=0;o<this.row_length;o++)e[o]=this.matrix_array[o][n];var i=t(e);r._resize(Math.max(r.row_length,i.length),r.column_length);for(var a=0;a<i.length;a++)r.matrix_array[a][n]=i[a]}return r},$.prototype.eachVector=function(t,r){var n=void 0!==r?r:"auto";if("string"==typeof n?n=n.toLocaleLowerCase():"number"!=typeof n&&(n=$._toInteger(n)),"auto"===n||0===n)return this.eachVectorAuto(t);if("row"===n||1===n)return this.eachVectorRow(t);if("column"===n||2===n)return this.eachVectorColumn(t);if("both"===n||3===n)return this.eachVectorBoth(t);throw"eachVector argument "+r},$.prototype.getMatrix=function(t,r,n){void 0===n&&(n=!1);for(var e=n?1:0,o=y.toPositionArrayFromObject(t,this.row_length,e),i=y.toPositionArrayFromObject(r,this.column_length,e),a=this.matrix_array,u=new Array(o.length),h=0;h<o.length;h++){for(var s=new Array(i.length),l=0;l<i.length;l++)s[l]=a[o[h]-e][i[l]-e];u[h]=s}return new $(u)},$.prototype.setMatrix=function(t,r,n,e){void 0===e&&(e=!1);for(var o=e?1:0,i=y.toPositionArrayFromObject(t,this.row_length,o),a=y.toPositionArrayFromObject(r,this.column_length,o),u=new $(this).matrix_array,h=$._toMatrix(n),s=h.matrix_array,l=0;l<i.length;l++)for(var c=0;c<a.length;c++)u[i[l]-o][a[c]-o]=s[l%h.row_length][c%h.column_length];return new $(u)},$.prototype.getComplex=function(t,r){var n=null,e=null;return 1===arguments.length?n=$._toInteger(t):2===arguments.length&&(n=$._toInteger(t),e=$._toInteger(r)),this.isRow()?this.matrix_array[0][n]:this.isColumn()?this.matrix_array[n][0]:this.matrix_array[n][e]},$.prototype.booleanValue=function(){return this.matrix_array[0][0].booleanValue()},$.prototype.intValue=function(){return this.matrix_array[0][0].intValue()},$.prototype.doubleValue=function(){return this.matrix_array[0][0].doubleValue()},$.prototype.toComplex=function(){return this.scalar()},$.prototype.toMatrix=function(){return this},$.prototype.scalar=function(){return this.matrix_array[0][0]},$.prototype.length=function(){return this.row_length>this.column_length?this.row_length:this.column_length},$.prototype.width=function(){return this.column_length},$.prototype.height=function(){return this.row_length},$.prototype.norm1=function(){return c.norm(this,1)},$.prototype.norm2=function(){return c.norm(this,2)},$.prototype.norm=function(t){return c.norm(this,t)},$.prototype.cond=function(t){return c.cond(this,t)},$.prototype.rcond=function(){return c.rcond(this)},$.prototype.rank=function(t){return c.rank(this,t)},$.prototype.trace=function(){return c.trace(this)},$.prototype.det=function(){return c.det(this)},$.memset=function(t,r,n){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";var e=$._toMatrix(t);if(e.isScalar()){var o=e.scalar();return $.createMatrixDoEachCalculation(function(){return o},r,n)}var i=e.matrix_array,a=e.row_length,u=e.column_length;return $.createMatrixDoEachCalculation(function(t,r){return i[t%a][r%u]},r,n)},$.eye=function(t,r){return $.createMatrixDoEachCalculation(function(t,r){return t===r?A.ONE:A.ZERO},t,r)},$.zeros=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return $.memset(A.ZERO,t,r)},$.ones=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return $.memset(A.ONE,t,r)},$.prototype.diag=function(){if(this.isVector()){var n=this;return $.createMatrixDoEachCalculation(function(t,r){return t===r?n.getComplex(t):A.ZERO},this.length())}for(var t=Math.min(this.row_length,this.column_length),r=new Array(t),e=0;e<t;e++)r[e]=new Array(1),r[e][0]=this.matrix_array[e][e];return new $(r)},$.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},$.prototype.isRow=function(){return 1===this.row_length},$.prototype.isColumn=function(){return 1===this.column_length},$.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},$.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},$.prototype.isSquare=function(){return this.row_length===this.column_length},$.prototype.isReal=function(r){var n=!0;return this._each(function(t){n&&t.isComplex(r)&&(n=!1)}),n},$.prototype.isComplex=function(t){return!this.isReal(t)},$.prototype.isZeros=function(t){var r=!0,n=t||1e-10;return this._each(function(t){r&&!t.isZero(n)&&(r=!1)}),r},$.prototype.isIdentity=function(t){var e=!0,o=t||1e-10;return this._each(function(t,r,n){e&&(r===n?t.isOne(o)||(e=!1):t.isZero(o)||(e=!1))}),e},$.prototype.isDiagonal=function(t){var e=!0,o=t||1e-10;return this._each(function(t,r,n){e&&r!==n&&!t.isZero(o)&&(e=!1)}),e},$.prototype.isTridiagonal=function(t){var e=!0,o=t||1e-10;return this._each(function(t,r,n){e&&1<Math.abs(r-n)&&!t.isZero(o)&&(e=!1)}),e},$.prototype.isRegular=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.rank(r)===this.row_length},$.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.transpose()).isIdentity(r)},$.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.ctranspose()).isIdentity(r)},$.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,n=0;n<this.row_length;n++)for(var e=n+1;e<this.column_length;e++)if(!this.matrix_array[n][e].equals(this.matrix_array[e][n],r))return!1;return!0},$.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,n=0;n<this.row_length;n++)for(var e=n;e<this.column_length;e++)if(n===e){if(!this.matrix_array[n][e].isReal(r))return!1}else if(!this.matrix_array[n][e].equals(this.matrix_array[e][n].conj(),r))return!1;return!0},$.prototype.isTriangleUpper=function(t){var e=!0,o=t||1e-10;return this._each(function(t,r,n){e&&n<r&&!t.isZero(o)&&(e=!1)}),e},$.prototype.isTriangleLower=function(t){var e=!0,o=t||1e-10;return this._each(function(t,r,n){e&&r<n&&!t.isZero(o)&&(e=!1)}),e},$.prototype.isPermutation=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,n=new Array(this.row_length),e=new Array(this.column_length),o=0;o<this.row_length;o++)for(var i=0;i<this.column_length;i++){var a=this.matrix_array[o][i];if(a.isOne(r)){if(n[o]||e[i])return!1;n[o]=1,e[i]=1}else if(!a.isZero(r))return!1}for(var u=0;u<this.row_length;u++)if(void 0===n[u]||void 0===e[u])return!1;return!0},$.prototype.size=function(t){if(void 0!==t){var r=t;if("string"==typeof r?r=r.toLocaleLowerCase():"number"!=typeof r&&(r=$._toInteger(r)),"row"===r||1===r)return new $(this.row_length);if("column"===r||2===r)return new $(this.column_length)}return new $([[this.row_length,this.column_length]])},$.prototype.compareTo=function(t,r){var n=$._toMatrix(t);if(this.isScalar()&&n.isScalar())return this.scalar().compareTo(n.scalar(),r);throw"IllegalArgumentException"},$.prototype.compareToMatrix=function(t,n){var e=this,o=$._toMatrix(t),i=e.matrix_array,a=o.matrix_array,r=Math.max(e.row_length,o.row_length),u=Math.max(e.column_length,o.column_length);return $.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].compareTo(a[t%o.row_length][r%o.column_length],n)},r,u)},$.prototype.add=function(t){var n=this,e=$._toMatrix(t);if(n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].add(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.sub=function(t){var n=this,e=$._toMatrix(t);if(n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].sub(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.mul=function(t){var r=this,n=$._toMatrix(t),e=r.matrix_array,o=n.matrix_array;if(r.isScalar()&&n.isScalar())return new $(r.scalar().mul(n.scalar()));if(r.isScalar()){for(var i=new Array(n.row_length),a=0;a<n.row_length;a++){i[a]=new Array(n.column_length);for(var u=0;u<n.column_length;u++)i[a][u]=r.scalar().mul(o[a][u])}return new $(i)}if(n.isScalar()){for(var h=new Array(r.row_length),s=0;s<r.row_length;s++){h[s]=new Array(r.column_length);for(var l=0;l<r.column_length;l++)h[s][l]=e[s][l].mul(n.scalar())}return new $(h)}if(r.column_length!==n.row_length)throw"Matrix size does not match";for(var c=new Array(r.row_length),f=0;f<r.row_length;f++){c[f]=new Array(n.column_length);for(var _=0;_<n.column_length;_++){for(var p=A.ZERO,m=0;m<r.column_length;m++)p=p.add(e[f][m].mul(o[m][_]));c[f][_]=p}}return new $(c)},$.prototype.div=function(t){var r=this,n=$._toMatrix(t),e=r.matrix_array;if(r.isScalar()&&n.isScalar())return new $(r.scalar().div(n.scalar()));if(n.isScalar()){for(var o=new Array(r.row_length),i=0;i<r.row_length;i++){o[i]=new Array(r.column_length);for(var a=0;a<r.column_length;a++)o[i][a]=e[i][a].div(n.scalar())}return new $(o)}if(n.row_length===n.column_length){return 1e-10<n.det().scalar().norm()?this.mul(n.inv()):this.mul(n.pinv())}if(r.column_length!==n.column_length)throw"Matrix size does not match";throw"warning"},$.prototype.inv=function(){return c.inv(this)},$.prototype.dotmul=function(t){var n=this,e=$._toMatrix(t);if(!n.isScalar()&&!e.isScalar()&&n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].mul(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.dotdiv=function(t){var n=this,e=$._toMatrix(t);if(!n.isScalar()&&!e.isScalar()&&n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].div(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.dotinv=function(){var n=this.matrix_array;return $.createMatrixDoEachCalculation(function(t,r){return n[t][r].inv()},this.row_length,this.column_length)},$.prototype.nmul=function(t){return this.dotmul(t)},$.prototype.ndiv=function(t){return this.dotdiv(t)},$.prototype.ninv=function(){return this.dotinv()},$.prototype.npow=function(t){return this.dotpow(t)},$.prototype.rem=function(t){var n=this,e=$._toMatrix(t);if(!n.isScalar()&&!e.isScalar()&&n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].rem(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.mod=function(t){var n=this,e=$._toMatrix(t);if(!n.isScalar()&&!e.isScalar()&&n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].mod(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new A(t.real())})},$.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new A(t.imag())})},$.prototype.arg=function(){return this.cloneMatrixDoEachCalculation(function(t){return new A(t.arg())})},$.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new A(t.sign())})},$.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},$.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},$.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},$.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},$.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},$.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},$.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},$.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},$.prototype.pow=function(t){if(this.isScalar())return new $(this.scalar().pow($._toDouble(t)));if(!this.isSquare())throw"not square "+this;var r,n,e=$._toInteger(t);if(e<0)throw"error negative number "+e;for(r=this.clone(),n=$.eye(this.length());0!==e;)0!=(1&e)&&(n=n.mul(r)),r=r.mul(r),e>>>=1;return n},$.prototype.dotpow=function(t){var n=this,e=$._toMatrix(t);if(!n.isScalar()&&!e.isScalar()&&n.row_length!==e.row_length&&n.column_length!==e.column_length)throw"Matrix size does not match";var o=n.matrix_array,i=e.matrix_array,r=Math.max(n.row_length,e.row_length),a=Math.max(n.column_length,e.column_length);return $.createMatrixDoEachCalculation(function(t,r){return o[t%n.row_length][r%n.column_length].pow(i[t%e.row_length][r%e.column_length])},r,a)},$.prototype.square=function(){return this.pow(2)},$.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},$.prototype.cbrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cbrt()})},$.prototype.rsqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.rsqrt()})},$.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},$.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},$.prototype.expm1=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.expm1()})},$.prototype.log1p=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log1p()})},$.prototype.log2=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log2()})},$.prototype.log10=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log10()})},$.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},$.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},$.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},$.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},$.prototype.atan2=function(t){var r=$._toComplex(t);return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(r)})},$.prototype.asin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asin()})},$.prototype.acos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acos()})},$.prototype.sinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinh()})},$.prototype.asinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asinh()})},$.prototype.cosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cosh()})},$.prototype.acosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acosh()})},$.prototype.tanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tanh()})},$.prototype.atanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atanh()})},$.prototype.sec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sec()})},$.prototype.asec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asec()})},$.prototype.sech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sech()})},$.prototype.asech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asech()})},$.prototype.cot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cot()})},$.prototype.acot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acot()})},$.prototype.coth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.coth()})},$.prototype.acoth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acoth()})},$.prototype.csc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csc()})},$.prototype.acsc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsc()})},$.prototype.csch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csch()})},$.prototype.acsch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsch()})},$.prototype.logit=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.logit()})},$.prototype.sinc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinc()})},$.rand=function(t,r,n){return $.createMatrixDoEachCalculation(function(){return A.rand(n)},t,r)},$.randn=function(t,r,n){return $.createMatrixDoEachCalculation(function(){return A.randn(n)},t,r)},$.prototype.testInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(r)?A.ONE:A.ZERO})},$.prototype.testComplexInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(r)?A.ONE:A.ZERO})},$.prototype.testZero=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(r)?A.ONE:A.ZERO})},$.prototype.testOne=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(r)?A.ONE:A.ZERO})},$.prototype.testComplex=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(r)?A.ONE:A.ZERO})},$.prototype.testReal=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(r)?A.ONE:A.ZERO})},$.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?A.ONE:A.ZERO})},$.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?A.ONE:A.ZERO})},$.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?A.ONE:A.ZERO})},$.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?A.ONE:A.ZERO})},$.prototype.testPositiveInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositiveInfinity()?A.ONE:A.ZERO})},$.prototype.testNegativeInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegativeInfinity()?A.ONE:A.ZERO})},$.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?A.ONE:A.ZERO})},$.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?A.ONE:A.ZERO})},$.prototype.isZero=function(t){return this.scalar().isZero(t)},$.prototype.isOne=function(t){return this.scalar().isOne(t)},$.prototype.isPositive=function(){return this.scalar().isPositive()},$.prototype.isNegative=function(){return this.scalar().isNegative()},$.prototype.isNotNegative=function(){return this.scalar().isNotNegative()},$.prototype.isNaN=function(){return this.scalar().isNaN()},$.prototype.isPositiveInfinity=function(){return this.scalar().isPositiveInfinity()},$.prototype.isNegativeInfinity=function(){return this.scalar().isNegativeInfinity()},$.prototype.isInfinite=function(){return this.scalar().isInfinite()},$.prototype.isFinite=function(){return this.scalar().isFinite()},$.prototype.isInteger=function(t){return this.scalar().isInteger(t)},$.prototype.isComplexInteger=function(t){return this.scalar().isComplexInteger(t)},$.prototype._rot90=function(t){var r=$._toInteger(t),n=1;if(1===arguments.length&&(n=(r%4+4)%4),0===n)return this;for(var e=new Array(this.row_length),o=0;o<this.row_length;o++){e[o]=new Array(this.column_length);for(var i=0;i<this.column_length;i++)e[o][i]=this.matrix_array[o][i]}var a=this.matrix_array;if(1===n){a.splice(this.column_length);for(var u=0;u<this.column_length;u++){u<this.row_length?a[u].splice(this.row_length):a[u]=new Array(this.row_length);for(var h=0;h<this.row_length;h++)a[u][h]=e[this.row_length-h-1][u]}}else if(2===n)for(var s=0;s<this.row_length;s++)for(var l=0;l<this.column_length;l++)a[s][l]=e[this.row_length-s-1][this.column_length-l-1];else if(3===n){a.splice(this.column_length);for(var c=0;c<this.column_length;c++){c<this.row_length?a[c].splice(this.row_length):a[c]=new Array(this.row_length);for(var f=0;f<this.row_length;f++)a[c][f]=e[f][this.column_length-c-1]}}return this.row_length=a.length,this.column_length=a[0].length,this._clearCash(),this},$.prototype.rot90=function(t){return this.clone()._rot90(t)},$.prototype._resize=function(t,r){var n=$._toInteger(t),e=$._toInteger(r);if(n===this.row_length&&e===this.column_length)return this;if(n<=0||e<=0)throw"_resize";for(var o=Math.max(this.row_length,n),i=Math.max(this.column_length,e),a=this.matrix_array,u=0;u<o;u++){u>=this.row_length&&(a[u]=new Array(i));for(var h=0;h<i;h++)(u>=this.row_length||h>=this.column_length)&&(a[u][h]=A.ZERO)}if(this.row_length>n&&a.splice(n),this.column_length>e)for(var s=0;s<a.length;s++)a[s].splice(e);return this.row_length=n,this.column_length=e,this._clearCash(),this},$.prototype.resize=function(t,r){return this.clone()._resize(t,r)},$.prototype._deleteRow=function(t){var r=$._toInteger(t);if(1===this.row_length||this.row_length<=r)throw"_deleteRow";return this.matrix_array.splice(r,1),this.row_length--,this._clearCash(),this},$.prototype._deleteColumn=function(t){var r=$._toInteger(t);if(1===this.column_length||this.column_length<=r)throw"_deleteColumn";for(var n=0;n<this.row_length;n++)this.matrix_array[n].splice(r,1);return this.column_length--,this._clearCash(),this},$.prototype.deleteRow=function(t){return this.clone()._deleteRow(t)},$.prototype.deleteColumn=function(t){return this.clone()._deleteColumn(t)},$.prototype._exchangeRow=function(t,r){var n=$._toInteger(t),e=$._toInteger(r);if(1===this.row_length||this.row_length<=n||this.row_length<=e)throw"_exchangeRow";if(n===e)return this;var o=this.matrix_array[n];return this.matrix_array[n]=this.matrix_array[e],this.matrix_array[e]=o,this._clearCash(),this},$.prototype._exchangeColumn=function(t,r){var n=$._toInteger(t),e=$._toInteger(r);if(1===this.column_length||this.column_length<=n||this.column_length<=e)throw"_exchangeColumn";if(n===e)return this;for(var o=0;o<this.row_length;o++){var i=this.matrix_array[o][n];this.matrix_array[o][n]=this.matrix_array[o][e],this.matrix_array[o][e]=i}return this._clearCash(),this},$.prototype.exchangeRow=function(t,r){return this.clone()._exchangeRow(t,r)},$.prototype.exchangeColumn=function(t,r){return this.clone()._exchangeColumn(t,r)},$.prototype._concatRight=function(t){var r=$._toMatrix(t);if(this.row_length!=r.row_length)throw"_concatRight";for(var n=0;n<this.row_length;n++)for(var e=0;e<r.column_length;e++)this.matrix_array[n].push(r.matrix_array[n][e]);return this.column_length+=r.column_length,this._clearCash(),this},$.prototype._concatBottom=function(t){var r=$._toMatrix(t);if(this.column_length!=r.column_length)throw"_concatBottom";for(var n=0;n<r.row_length;n++)this.matrix_array.push(r.matrix_array[n]);return this.row_length+=r.row_length,this._clearCash(),this},$.prototype.concatRight=function(t){return this.clone()._concatRight(t)},$.prototype.concatBottom=function(t){return this.clone()._concatBottom(t)},$.prototype.clip=function(t,r){var i=$._toMatrix(t),a=$._toMatrix(r),u=i.matrix_array,h=a.matrix_array;return this.cloneMatrixDoEachCalculation(function(t,r,n){var e=u[r%i.row_length][n%i.column_length],o=h[r%a.row_length][n%a.column_length];return t.clip(e,o)})},$.arange=function(t,r,n){var e=void 0!==r?$._toComplex(t):A.ZERO,o=void 0!==r?$._toComplex(r):$._toComplex(t),i=void 0!==n?$._toComplex(n):A.ONE;return new $(y.InterpolationCalculation(e,i,o,!1))},$.prototype.circshift=function(t,r){var o=$._toInteger(t),n=r&&r.dimension?r.dimension:"auto";return this.eachVector(function(t){for(var r=new Array(t.length),n=(-o%t.length+t.length)%t.length,e=0;e<t.length;e++)r[e]=t[n++],n===t.length&&(n=0);return r},n)},$.prototype.roll=function(t,r){return this.circshift(t,r)},$.prototype.reshape=function(t,r){var n=$._toInteger(t),e=$._toInteger(r),o=this.row_length*this.column_length,i=n*e;if(o!=i)throw"reshape error. (this_size !== new_size)->("+o+" !== "+i+")";for(var a=this.matrix_array,u=0,h=0,s=new Array(n),l=0;l<n;l++){s[l]=new Array(e);for(var c=0;c<e;c++)s[l][c]=a[h][u],++u===this.column_length&&(u=0,h++)}return new $(s)},$.prototype.fliplr=function(){return this.flip({dimension:"row"})},$.prototype.flipud=function(){return this.flip({dimension:"column"})},$.prototype.flip=function(t){var r=t&&t.dimension?t.dimension:"auto";return this.eachVector(function(t){for(var r=new Array(t.length),n=0,e=t.length-1;n<t.length;n++,e--)r[n]=t[e];return r},r)},$.prototype.indexsort=function(t){var r=$._toMatrix(t);if(r.isMatrix())throw"argsort error. argsort is not vector. ("+r.toOneLineString+")";var n=!1,e=null,o=null;if(r.isRow()){if(this.column_length!==r.column_length)throw"argsort error. (this_size !== new_size)->("+this.column_length+" !== "+r.column_length+")";n=!0,e=this.transpose().matrix_array,o=r.matrix_array[0]}if(r.isColumn()){if(this.row_length!==r.row_length)throw"argsort error. (this_size !== new_size)->("+this.row_length+" !== "+r.row_length+")";e=this.matrix_array,o=r.transpose().matrix_array[0]}for(var i=new Array(o.length),a=0;a<o.length;a++)i[a]={index:o[a],data:e[a]};var s=[],l=function(t,r,n,e){if(r<n){var o=Math.floor((r+n)/2);l(t,r,o,e),l(t,o+1,n,e);var i,a,u,h=0;for(i=r;i<=o;i++)s[h++]=t[i];for(i=o+1,a=0,u=r;i<=n&&a<h;)0<=e(t[i],s[a])?t[u++]=s[a++]:t[u++]=t[i++];for(;a<h;)t[u++]=s[a++]}return!0};l(i,0,i.length-1,function(t,r){return t.index.compareTo(r.index)});for(var u=new Array(o.length),h=0;h<o.length;h++)u[h]=i[h].data;var c=new $(u);return n?c.transpose():c},$.prototype.transpose=function(){for(var t=new Array(this.column_length),r=0;r<this.column_length;r++){t[r]=new Array(this.row_length);for(var n=0;n<this.row_length;n++)t[r][n]=this.matrix_array[n][r]}return new $(t)},$.prototype.ctranspose=function(){return this.transpose().conj()},$.prototype.T=function(){return this.ctranspose()},$.prototype.inner=function(t,r){return void 0===r&&(r=1),c.inner(this,t,r)},$.prototype.lup=function(){return c.lup(this)},$.prototype.lu=function(){return c.lu(this)},$.prototype.linsolve=function(t){return c.linsolve(this,t)},$.prototype.qr=function(){return c.qr(this)},$.prototype.tridiagonalize=function(){return c.tridiagonalize(this)},$.prototype.eig=function(){return c.eig(this)},$.prototype.svd=function(){return c.svd(this)},$.prototype.pinv=function(){return c.pinv(this)},$.prototype.gammaln=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gammaln()})},$.prototype.gamma=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gamma()})},$.prototype.gammainc=function(t,r){var n=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.gammainc(n,r)})},$.prototype.gampdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.gampdf(n,e)})},$.prototype.gamcdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.gamcdf(n,e)})},$.prototype.gaminv=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.gaminv(n,e)})},$.prototype.beta=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.beta(r)})},$.prototype.betainc=function(t,r,n){var e=$._toDouble(t),o=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.betainc(e,o,n)})},$.prototype.betacdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.betacdf(n,e)})},$.prototype.betapdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.betapdf(n,e)})},$.prototype.betainv=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.betainv(n,e)})},$.prototype.factorial=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.factorial()})},$.prototype.nchoosek=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.nchoosek(r)})},$.prototype.erf=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erf()})},$.prototype.erfc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfc()})},$.prototype.erfinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfinv()})},$.prototype.erfcinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfcinv()})},$.prototype.normpdf=function(t,r){var n=void 0!==t?$._toDouble(t):0,e=void 0!==r?$._toDouble(r):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normpdf(n,e)})},$.prototype.normcdf=function(t,r){var n=void 0!==t?$._toDouble(t):0,e=void 0!==r?$._toDouble(r):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normcdf(n,e)})},$.prototype.norminv=function(t,r){var n=void 0!==t?$._toDouble(t):0,e=void 0!==r?$._toDouble(r):1;return this.cloneMatrixDoEachCalculation(function(t){return t.norminv(n,e)})},$.prototype.binopdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.binopdf(n,e)})},$.prototype.binocdf=function(t,r,n){var e=$._toDouble(t),o=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.binocdf(e,o,n)})},$.prototype.binoinv=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.binoinv(n,e)})},$.prototype.poisspdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisspdf(r)})},$.prototype.poisscdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisscdf(r)})},$.prototype.poissinv=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poissinv(r)})},$.prototype.tpdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tpdf(r)})},$.prototype.tcdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tcdf(r)})},$.prototype.tinv=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv(r)})},$.prototype.tdist=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.tdist(n,e)})},$.prototype.tinv2=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv2(r)})},$.prototype.chi2pdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2pdf(r)})},$.prototype.chi2cdf=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2cdf(r)})},$.prototype.chi2inv=function(t){var r=$._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2inv(r)})},$.prototype.fpdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.fpdf(n,e)})},$.prototype.fcdf=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.fcdf(n,e)})},$.prototype.finv=function(t,r){var n=$._toDouble(t),e=$._toDouble(r);return this.cloneMatrixDoEachCalculation(function(t){return t.finv(n,e)})},$.prototype.and=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.and($._toDouble(r))})},$.prototype.or=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.or($._toDouble(r))})},$.prototype.xor=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.xor($._toDouble(r))})},$.prototype.not=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.not()})},$.prototype.shift=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.shift($._toDouble(r))})},$.prototype.scaleByPowerOfTen=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.scaleByPowerOfTen($._toComplex(r))})},$.prototype.max=function(t){return N.max(this,t)},$.prototype.min=function(t){return N.min(this,t)},$.prototype.sum=function(t){return N.sum(this,t)},$.prototype.mean=function(t){return N.mean(this,t)},$.prototype.prod=function(t){return N.prod(this,t)},$.prototype.geomean=function(t){return N.geomean(this,t)},$.prototype.median=function(t){return N.median(this,t)},$.prototype.mode=function(t){return N.mode(this,t)},$.prototype.moment=function(t,r){return N.moment(this,t,r)},$.prototype.variance=function(t){return N.variance(this,t)},$.prototype.std=function(t){return N.std(this,t)},$.prototype.mad=function(t,r){return N.mad(this,t,r)},$.prototype.skewness=function(t){return N.skewness(this,t)},$.prototype.cov=function(t,r){return N.cov(this,t,r)},$.prototype.standardization=function(t){return N.standardization(this,t)},$.prototype.corrcoef=function(t,r){return N.corrcoef(this,t,r)},$.prototype.sort=function(t,r){return N.sort(this,t,r)},$.prototype.fft=function(t){return p.fft(this,t)},$.prototype.ifft=function(t){return p.ifft(this,t)},$.prototype.powerfft=function(t){return p.powerfft(this,t)},$.prototype.dct=function(t){return p.dct(this,t)},$.prototype.idct=function(t){return p.idct(this,t)},$.prototype.fft2=function(){return p.fft2(this)},$.prototype.ifft2=function(){return p.ifft2(this)},$.prototype.dct2=function(){return p.dct2(this)},$.prototype.idct2=function(){return p.idct2(this)},$.prototype.conv=function(t){return p.conv(this,t)},$.prototype.xcorr=function(t){return p.xcorr(this,t)},$.window=function(t,r,n){return p.window(t,r,n)},$.hann=function(t,r){return p.hann(t,r)},$.hamming=function(t,r){return p.hamming(t,r)},$.prototype.fftshift=function(t){return p.fftshift(this,t)},$.prototype.signum=function(){return this.sign()},$.prototype.subtract=function(t){return this.sub(t)},$.prototype.multiply=function(t){return this.mul(t)},$.prototype.divide=function(t){return this.div(t)},$.prototype.remainder=function(t){return this.rem(t)},$.prototype.trunc=function(){return this.fix()},$.prototype.isMatrixData=function(){return!0},$.ONE=new $(1),$.TWO=new $(2),$.TEN=new $(10),$.ZERO=new $(0),$.MINUS_ONE=new $(-1),$.I=new $(A.I),$.PI=new $(Math.PI),$.QUARTER_PI=new $(.25*Math.PI),$.HALF_PI=new $(.5*Math.PI),$.TWO_PI=new $(2*Math.PI),$.E=new $(Math.E),$.LN2=new $(Math.LN2),$.LN10=new $(Math.LN10),$.LOG2E=new $(Math.LOG2E),$.LOG10E=new $(Math.LOG10E),$.SQRT2=new $(Math.SQRT2),$.SQRT1_2=new $(Math.SQRT1_2),$.HALF=new $(.5),$.POSITIVE_INFINITY=new $(Number.POSITIVE_INFINITY),$.NEGATIVE_INFINITY=new $(Number.NEGATIVE_INFINITY),$.NaN=new $(Number.NaN);function w(){}w.runPrincipalComponentAnalysis=function(t){var n=$.create(t.samples),r={correction:void 0!==t.is_unbiased&&t.is_unbiased?1:0};t.is_standardised&&(n=n.standardization(r));var e=n.cov(r).svd(),o=e.S.diag(),i=e.U.T().negate(),a=i.dotpow(2),u=o.sum(),h=o.dotdiv(u),s=A.ZERO,l=$.createMatrixDoEachCalculation(function(t,r){return s=s.add(h.getComplex(t+r))},h.column_length,h.row_length);n=n.sub(n.mean({dimension:"column"}));for(var c=$.createMatrixDoEachCalculation(function(t,r){return n.getMatrix(r,":").dotmul(i.getMatrix(t,":")).sum()},o.length(),n.size(1)),f=o.T().getNumberMatrixArray()[0],_=i.getNumberMatrixArray(),p=a.getNumberMatrixArray(),m=l.getNumberMatrixArray()[0],g=h.T().getNumberMatrixArray()[0],v=c.getNumberMatrixArray(),y=[],w=0;w<o.length();w++)y.push({eigen_value:f[w],factor_loading:_[w],factor_loading_contribution_rate:p[w],cumulative_contribution_ratio:m[w],contribution_ratio:g[w],score:v[w]});return{principal_component:y}};function d(){}d.runMultipleRegressionAnalysis=function(t){var r=$.create(t.samples),n=$.create(t.target),e={correction:1};t.is_standardised&&(r=r.standardization(),n=n.standardization());var o=$.create(r.width()),i=$.create(r.height()),a=r.cov(e),u=a.rcond();if(u<=1e-10)return console.log("Analysis failed due to highly correlated explanatory variables.(rcond : "+u+")"),null;for(var h=[],s=o.intValue(),l=0;l<s;l++)h[l]=[r.getMatrix(":",l).cov(n,e)];for(var c=$.create(h),f=a.inv().mul(c),_=n.mean().sub(r.mean().mul(f)),p=r.mul(f).add(_),m=p.variance(e),g=n.variance(e),v=p.corrcoef(n,e),y=m.div(g),w=o,d=p.sub(n.mean()).dotpow(2).sum(),x=d.div(w),M=i.sub(o).sub(1),b=p.sub(n).dotpow(2).sum(),N=b.div(M),E=i.sub(1),I=n.sub(n.mean()).dotpow(2).sum(),D=I.div(E),C=N,A=C.sqrt(),O=x.div(N),S=$.ONE.sub(O.fcdf(w,M)),R=$.ONE.sub(N.div(D)),T=i.mul(b.div(i).mul(2*Math.PI).log().add(1)).add(o.add(2).mul(2)),z=a.dotmul(i).inv(),V={coefficient:$.ZERO,standard_error:$.ZERO,t_stat:$.ZERO,p_value:$.ZERO,lower_95:$.ZERO,upper_95:$.ZERO},P=[],F=0;F<s;F++)P[F]={coefficient:$.ZERO,standard_error:$.ZERO,t_stat:$.ZERO,p_value:$.ZERO,lower_95:$.ZERO,upper_95:$.ZERO};V.coefficient=_;for(var q=0;q<s;q++)P[q].coefficient=new $(f.getComplex(q));for(var Z=o.intValue(),L=i.inv(),G=0;G<Z;G++)for(var k=0;k<Z;k++)L=L.add(r.getMatrix(":",G).mean().mul(r.getMatrix(":",k).mean()).mul(z.getMatrix(G,k)));V.standard_error=L.mul(C).sqrt();for(var Y=0;Y<s;Y++)P[Y].standard_error=z.getMatrix(Y,Y).mul(C).sqrt();function U(t){t.t_stat=t.coefficient.div(t.standard_error),t.p_value=t.t_stat.tdist(M,2);var r=new $(1-.95);t.lower_95=t.coefficient.sub(r.tinv2(M).mul(t.standard_error)),t.upper_95=t.coefficient.add(r.tinv2(M).mul(t.standard_error))}U(V);for(var Q=0;Q<s;Q++)U(P[Q]);for(var j,B={coefficient:V.coefficient.doubleValue(),standard_error:V.standard_error.doubleValue(),t_stat:V.t_stat.doubleValue(),p_value:V.p_value.doubleValue(),lower_95:V.lower_95.doubleValue(),upper_95:V.upper_95.doubleValue()},H=[],W=0;W<s;W++)H.push({coefficient:P[W].coefficient.doubleValue(),standard_error:P[W].standard_error.doubleValue(),t_stat:P[W].t_stat.doubleValue(),p_value:P[W].p_value.doubleValue(),lower_95:P[W].lower_95.doubleValue(),upper_95:P[W].upper_95.doubleValue()});return j={intercept:B,parameters:H},{q:o.doubleValue(),n:i.doubleValue(),predicted_values:p.getNumberMatrixArray(),sY:m.doubleValue(),sy:g.doubleValue(),multiple_R:v.doubleValue(),R_square:y.doubleValue(),adjusted_R_square:R.doubleValue(),ANOVA:{regression:{df:w.doubleValue(),SS:d.doubleValue(),MS:x.doubleValue()},residual:{df:M.doubleValue(),SS:b.doubleValue(),MS:N.doubleValue()},total:{df:E.doubleValue(),SS:I.doubleValue(),MS:D.doubleValue()},F:O.doubleValue(),significance_F:S.doubleValue()},Ve:C.doubleValue(),standard_error:A.doubleValue(),AIC:T.doubleValue(),regression_table:j}};function x(){}x.runPrincipalComponentAnalysis=function(t){return w.runPrincipalComponentAnalysis(t)},x.runMultipleRegressionAnalysis=function(t){return d.runMultipleRegressionAnalysis(t)};var b={Complex:A,Matrix:$,Probability:l,Statistics:N,LinearAlgebra:c,Signal:p,DataAnalysis:x},E=function(){return this}.apply(null,[]);return"Complex"in E||(Complex=A),"Matrix"in E||(Matrix=$),"Probability"in E||(Probability=l),"Statistics"in E||(Statistics=N),"LinearAlgebra"in E||(LinearAlgebra=c),"Signal"in E||(Signal=p),"DataAnalysis"in E||(DataAnalysis=x),b});
